import{a as L}from"https://app.framerstatic.com/chunk-R3NZHMAQ.mjs";import{a as b,b as R,f as C,i as g,k as V}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{a as D,b as I}from"https://app.framerstatic.com/chunk-NIDOI5EE.mjs";import{g as O}from"https://app.framerstatic.com/chunk-WDRGG64A.mjs";import{v as S}from"https://app.framerstatic.com/chunk-35MJ64JF.mjs";import{e as x,j as f}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";function j(t,a,s=[]){let i=[];for(let[n,e]of t.entries()){if(!g(e.submenu)&&!C(e.submenu))continue;let{submenu:r,...u}=e,m=s?[...s,n]:[n],o={...u,path:m};if(o.type==="separator"){if(n===0||n===t.length-1||i[i.length-1]?.type==="separator")continue;i.push(o);continue}if(e.disabled&&(o.enabled=!1),e.action&&(o.role=e.action),e.role&&a?.validateAction){let{states:p,options:l}=a.validateAction(e.role),d=p[e.role],{label:A,checked:h,visible:M}=l[e.role]??{};R(A)&&(o.label=A),g(e.checked)&&b(h)&&(o.checked=h),g(e.visible)&&b(M)&&(o.visible=M),g(e.disabled)&&g(e.enabled)&&b(d)&&(o.enabled=d)}if(e.visible===!1)continue;if(r){let p=j(r,a,m),l={...o,submenu:p};i.push(l);continue}let c=z(o,a);i.push(c)}return i.length>0&&i[i.length-1]?.type==="separator"&&i.pop(),i.length>0&&i[0]?.type==="separator"&&i.shift(),i}function z(t,a){if(!a)return t;let{appAccelerators:s,appAcceleratorsWindows:i}=a;if(!s||!i)return t;let{role:n}=t;if(!n)return t;let e={...t};return!L&&!t.acceleratorWindows&&(e.acceleratorWindows=i[n]),t.accelerator||(e.accelerator=s[n]),e}var q=S("wantsNativeTextActions");function P(t=document.activeElement){if(!(t instanceof HTMLElement))return!1;if(t.classList.contains("wantsNativeTextAction")||t instanceof HTMLIFrameElement)return!0;if(t instanceof HTMLInputElement)switch(t.type){case"date":case"datetime-local":case"email":case"month":case"number":case"password":case"search":case"tel":case"text":case"time":case"url":case"week":return!0;case"checkbox":case"color":case"file":case"image":case"radio":case"range":case"reset":case"submit":return!1;default:return q.reportErrorOncePerMinute("Unhandled input type: "+t.type),!1}return t instanceof HTMLTextAreaElement||t instanceof HTMLAnchorElement||t.closest("a")?!0:t.isContentEditable}var T=x(D());var B=x(I());function k(t){return t.wantsActions?t.wantsActions():!0}function E(t,a,s){return t.wantsAction?t.wantsAction(a,s):!0}function F(t,a){return t.optionsForAction?t.optionsForAction(a):void 0}var W;(i=>{function t(n){return new s(n)}i.chain=t;function a(n,e){return n&&n instanceof s?n.actionToTargetMap[e]:n}i.functionTarget=a;class s{constructor(e){f(this,"actionToTargetMap",{});f(this,"wantedActions",[]);this.then(e)}then(e){this.wantedActions=this.wantedActions.concat(e.wantedActions);let r=this.actionToTargetMap,u=e.wantedActions;for(let m of u)r[m]=r[m]||e;return this}wantsAction(e,r){let u=this.actionToTargetMap[e];return!u||!k(u)?!1:E(u,e,r)}optionsForAction(e){let r=this.actionToTargetMap[e];if(r)return F(r,e)}}})(W||={});var v=class extends Event{constructor(){super(...arguments);f(this,"actionIdentifier");f(this,"actionArgument")}};f(v,"eventType","vekter-action-dispatch-event");var y=class extends Event{constructor(){super(...arguments);f(this,"invalidatedActions");f(this,"validatedActionStates");f(this,"validatedActionOptions")}};f(y,"eventType","vekter-action-validation-event");function tt({target:t,engine:a,children:s,style:i,global:n}){let e=(0,T.useRef)(null),r=(0,T.useCallback)(o=>{let c=o.actionIdentifier;if(!c)return;let p=W.functionTarget(t,c);if(!p||!p.wantedActions.includes(c)||!k(p))return;let l=p[c];if(!V(l))return;let d=E(p,c,o);if(!d||(o.preventDefault(),o.stopPropagation(),d!==!0))return;a.setEditReason(c);let A=l.bind(p);a.scheduler.wrapHandler(A)(o.actionArgument)},[a,t]),u=(0,T.useCallback)(o=>{let{invalidatedActions:c,validatedActionStates:p,validatedActionOptions:l}=o;if(!(!c||!p||!l)&&t){for(let d of t.wantedActions)if(c.has(d)){c.delete(d);let A=k(t)?E(t,d,o):!1;if(p[d]=A,A===!0||A===!1){let h=F(t,d);h&&(l[d]=h)}}c.size===0&&(o.preventDefault(),o.stopPropagation())}},[t]);(0,T.useEffect)(()=>{if(!e.current)return;let o=(n?document.documentElement:null)||e.current;return o.addEventListener(v.eventType,r),o.addEventListener(y.eventType,u),()=>{o.removeEventListener(v.eventType,r),o.removeEventListener(y.eventType,u)}},[n,r,u]);let m=(0,T.useCallback)(o=>{!P(o.target)&&!O.isDebugBuild&&o.preventDefault()},[]);return(0,B.jsx)("div",{ref:e,onContextMenu:m,style:i,children:s})}function et(t,a){let s=document.activeElement;if(!s)throw Error("No active element for action dispatch");let i=new v(v.eventType,{bubbles:!0});return i.actionIdentifier=t,i.actionArgument=a,s.dispatchEvent(i)}function G(t){let a=document.activeElement;if(!a)throw Error("No active element for action validation");let s=new Set;for(let r of t)s.add(r);let i={},n={},e=new y(y.eventType,{bubbles:!0});return e.invalidatedActions=s,e.validatedActionStates=i,e.validatedActionOptions=n,a.dispatchEvent(e),{states:i,options:n}}var N=[],U=[];function nt(t){N.push(t)}function ot(t){U.push(t)}function it(t){let a=t==="*"?Object.keys(w):[t];N.forEach(n=>n());let{states:s,options:i}=G(a);Object.assign(w,s),Object.assign(H,i);for(let n of a)w[n]=s[n]||(n==="undo"||n==="redo"||n==="delete"?"native":!1);return U.forEach(n=>n()),{states:w,options:H}}var w={},H={};export{P as a,W as b,tt as c,et as d,nt as e,ot as f,it as g,j as h};
//# sourceMappingURL=https://app.framerstatic.com/chunk-GWDCOJRU.mjs.map
