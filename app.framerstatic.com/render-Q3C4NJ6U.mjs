import{a as bl}from"https://app.framerstatic.com/chunk-FOFPGX6Q.mjs";import"https://app.framerstatic.com/chunk-UECLN2HC.mjs";import{a as tt}from"https://app.framerstatic.com/chunk-MV6HOLQD.mjs";import{a as Fl}from"https://app.framerstatic.com/chunk-MTVPXQIM.mjs";import{a as Jo,b as xl,c as Pl}from"https://app.framerstatic.com/chunk-S6BEFCDZ.mjs";import"https://app.framerstatic.com/chunk-ICKKXAKW.mjs";import"https://app.framerstatic.com/chunk-5WV6RTQK.mjs";import{$b as $r,Ad as Cl,B as Yo,Bb as ks,Da as Yr,Dc as lo,Eb as Ms,Ec as nl,Hc as Zr,Ib as R,Ic as il,Jb as Ut,K as Gr,Kb as v,Lb as Os,Mb as Vs,Oc as co,Qc as Jr,Sc as al,Tc as sl,Wb as Ks,Xc as Wt,Za as As,Zc as ll,_a as Bs,_b as Gs,a as zo,ac as Ys,b as ws,bc as $s,bd as dl,c as Is,cc as Xs,dc as Xr,e as Us,fb as Ds,fd as cl,g as Cs,gd as fl,h as Fs,hd as ml,jd as pl,kd as ul,ld as gl,m as jo,n as xs,o as qo,oc as Zs,od as yl,pc as Js,pd as hl,q as Ko,qc as Qs,qd as Xo,r as Go,rc as tl,rd as Zo,s as Ps,sc as ol,tc as rl,u as bs,ud as H,w as vs,wd as wl,x as Ss,xb as Rs,xd as Il,y as Es,zd as Ul}from"https://app.framerstatic.com/chunk-GD3V5KOL.mjs";import"https://app.framerstatic.com/chunk-BP3TXYLI.mjs";import{a as et,d as Ws,f as Hs,g as zs}from"https://app.framerstatic.com/chunk-VQA3Y4TJ.mjs";import{h as hs}from"https://app.framerstatic.com/chunk-ULWX4RX3.mjs";import{J as ss}from"https://app.framerstatic.com/chunk-QN3HH7FY.mjs";import"https://app.framerstatic.com/chunk-VO6Z2JOG.mjs";import"https://app.framerstatic.com/chunk-IHOAENGB.mjs";import{$ as Ka,G as ka,H as Ma,Ja as Za,Q as wt,R as It,Ra as os,T as _,V as _a,W as za,X as ja,Y as Lo,Z as _o,_ as qa,aa as Ga,ba as Lt,da as Wo,ea as Ho,hb as ns,ib as ds,qa as $a,ya as Xa}from"https://app.framerstatic.com/chunk-E7ZU36TU.mjs";import{D as is,E as as,G as ls,J as cs,j as es,l as ts}from"https://app.framerstatic.com/chunk-QYDLTJ2P.mjs";import{xa as Ya}from"https://app.framerstatic.com/chunk-NDJDKMBM.mjs";import{$ as oa,Se as La,ca as ra,cd as Ra,da as x,ea as na,nc as Vo,pc as Da,se as Va}from"https://app.framerstatic.com/chunk-TAQLITMJ.mjs";import{f as Oa}from"https://app.framerstatic.com/chunk-SGE7S3UE.mjs";import"https://app.framerstatic.com/chunk-KQIDTEPV.mjs";import"https://app.framerstatic.com/chunk-EDICM4ZE.mjs";import"https://app.framerstatic.com/chunk-MTT6DWBN.mjs";import"https://app.framerstatic.com/chunk-5C7X4FEK.mjs";import"https://app.framerstatic.com/chunk-Z2EPYIAC.mjs";import"https://app.framerstatic.com/chunk-N57XNHE3.mjs";import"https://app.framerstatic.com/chunk-HDSXS2GO.mjs";import"https://app.framerstatic.com/chunk-RI2W6YF2.mjs";import"https://app.framerstatic.com/chunk-SE354WOV.mjs";import{i as Wa,j as Ha}from"https://app.framerstatic.com/chunk-YE4QPCYK.mjs";import"https://app.framerstatic.com/chunk-YXF2KFAS.mjs";import{c as el}from"https://app.framerstatic.com/chunk-PQAUFF2S.mjs";import"https://app.framerstatic.com/chunk-PM3HKRAT.mjs";import"https://app.framerstatic.com/chunk-GWDCOJRU.mjs";import"https://app.framerstatic.com/chunk-GT6WQMSO.mjs";import"https://app.framerstatic.com/chunk-4GEOIOUE.mjs";import"https://app.framerstatic.com/chunk-YE25YANI.mjs";import"https://app.framerstatic.com/chunk-L3CBECU4.mjs";import"https://app.framerstatic.com/chunk-4YR7YENT.mjs";import{a as _t}from"https://app.framerstatic.com/chunk-HV3OKKFY.mjs";import"https://app.framerstatic.com/chunk-EWEZCJKH.mjs";import"https://app.framerstatic.com/chunk-Q4ZQNAWB.mjs";import{a as ys}from"https://app.framerstatic.com/chunk-X7PME7OH.mjs";import{a as Aa,b as dt}from"https://app.framerstatic.com/chunk-BTZXTEZJ.mjs";import{b as Ns}from"https://app.framerstatic.com/chunk-H6C2Y2CW.mjs";import"https://app.framerstatic.com/chunk-D7MEQ7Y3.mjs";import"https://app.framerstatic.com/chunk-P7VPFO7Y.mjs";import"https://app.framerstatic.com/chunk-IBD76ZDY.mjs";import"https://app.framerstatic.com/chunk-FJ3VJUIB.mjs";import{j as Ba}from"https://app.framerstatic.com/chunk-IUW53DP6.mjs";import"https://app.framerstatic.com/chunk-ONNP42RG.mjs";import"https://app.framerstatic.com/chunk-YS3B4HMG.mjs";import{a as js,d as qs}from"https://app.framerstatic.com/chunk-LTVUCCFW.mjs";import"https://app.framerstatic.com/chunk-UNC7UEDE.mjs";import"https://app.framerstatic.com/chunk-45EZ2S6W.mjs";import"https://app.framerstatic.com/chunk-6P2Y6M26.mjs";import"https://app.framerstatic.com/chunk-ABHKVANM.mjs";import{a as Ts}from"https://app.framerstatic.com/chunk-5LBBN5VN.mjs";import{a as gs}from"https://app.framerstatic.com/chunk-MPEZWLBL.mjs";import{a as _s}from"https://app.framerstatic.com/chunk-XKKUVCT4.mjs";import{d as Qa,e as rs}from"https://app.framerstatic.com/chunk-UPSEOFNI.mjs";import{a as Ja}from"https://app.framerstatic.com/chunk-6YUMA2KF.mjs";import{g as ht,u as le}from"https://app.framerstatic.com/chunk-6IZ5CTSQ.mjs";import"https://app.framerstatic.com/chunk-35HHB5TS.mjs";import{Dc as qi,Dg as ko,Eg as ea,Ka as Ro,Ld as qr,Md as Kr,Sg as ta,Vb as zi,bd as Ki,be as Xi,ce as Zi,dc as ji,de as Ji,ee as Qi,la as zr,vd as Yi,wd as $i}from"https://app.framerstatic.com/chunk-DPLENNOO.mjs";import"https://app.framerstatic.com/chunk-7DZRNN4K.mjs";import{e as Gi,f as Ae}from"https://app.framerstatic.com/chunk-H4WBCNOK.mjs";import"https://app.framerstatic.com/chunk-Y4KSD2WZ.mjs";import"https://app.framerstatic.com/chunk-IVCB3DUV.mjs";import{d as Ls}from"https://app.framerstatic.com/chunk-6DVKAROJ.mjs";import"https://app.framerstatic.com/chunk-YOFBDBTL.mjs";import"https://app.framerstatic.com/chunk-6GUIIDJM.mjs";import{De as K,Ef as Mt,Ff as Ot,Hf as Vt,J as ca,Je as Qe,Jf as Oo,Jg as Na,Nc as ua,Ne as ha,Qe as wa,S as fa,Se as Ia,Tf as ba,_e as Mo,b as sa,cf as Ua,df as Ca,ef as Fa,gb as ma,h as la,m as da,ob as pa,og as va,pg as Sa,qe as ga,tg as Ea,ug as Ta,we as ya,xe as Pe,yf as xa,zf as Pa}from"https://app.framerstatic.com/chunk-SIIQYSAG.mjs";import"https://app.framerstatic.com/chunk-3LCEKAEC.mjs";import"https://app.framerstatic.com/chunk-NITQ6GUY.mjs";import"https://app.framerstatic.com/chunk-OOKYJP4H.mjs";import"https://app.framerstatic.com/chunk-BTVCB7HL.mjs";import{a as $o}from"https://app.framerstatic.com/chunk-RDEZD42O.mjs";import{a as ms}from"https://app.framerstatic.com/chunk-WPZCG576.mjs";import{a as Y}from"https://app.framerstatic.com/chunk-QFU6OGL3.mjs";import{a as fs,b as ps,c as us}from"https://app.framerstatic.com/chunk-CTKJD4ES.mjs";import"https://app.framerstatic.com/chunk-7P3PFQEE.mjs";import{Pe as Do,kc as Ne,o as Vi,p as Li,qd as Hi,qf as jr,wb as _i}from"https://app.framerstatic.com/chunk-3XJVYL4D.mjs";import{$e as Dt,Al as kt,B as ie,Dp as Ai,Ep as Bi,Gb as hi,Hb as wi,I as Te,Ib as V,Iq as Wr,Jc as Mr,Jq as Di,Ke as io,Le as Fi,Ne as Or,Pn as _r,Re as xi,Tl as Lr,Tt as so,Us as lt,Vs as Oi,Wf as Pi,Wj as Si,Wq as Hr,Ws as So,Xe as A,Xf as bi,Ye as Oe,Ys as Eo,Zd as Ui,Zi as Vr,Zn as Ei,_o as Ni,af as Je,ga as fe,hb as ui,he as xo,it as To,jb as gi,jt as No,kj as Po,kt as Ao,l as ne,lr as ki,lt as Bo,nc as Ii,oj as vi,ok as bo,ow as Wi,pc as Fo,qb as yi,qk as ao,te as Ci,uo as Ti,vc as Me,vk as vo}from"https://app.framerstatic.com/chunk-O7B2OPHS.mjs";import"https://app.framerstatic.com/chunk-VXJAAVJQ.mjs";import{e as Mi}from"https://app.framerstatic.com/chunk-6C6VSETA.mjs";import"https://app.framerstatic.com/chunk-FYUJQV6J.mjs";import"https://app.framerstatic.com/chunk-KYPY4QS7.mjs";import"https://app.framerstatic.com/chunk-VJQQCSHI.mjs";import"https://app.framerstatic.com/chunk-XFC6OVIX.mjs";import"https://app.framerstatic.com/chunk-R3NZHMAQ.mjs";import{K as at,n as di,x as ci,y as fi}from"https://app.framerstatic.com/chunk-WHDKBU2K.mjs";import{a as Ri,b as L}from"https://app.framerstatic.com/chunk-GO7WVIKP.mjs";import"https://app.framerstatic.com/chunk-XFC6OVIX.mjs";import"https://app.framerstatic.com/chunk-LH43QRIB.mjs";import{a as k,b as si}from"https://app.framerstatic.com/chunk-4AQCMAAQ.mjs";import"https://app.framerstatic.com/chunk-Q5MITPIS.mjs";import{a as ct}from"https://app.framerstatic.com/chunk-7GSEC7H4.mjs";import"https://app.framerstatic.com/chunk-SQ3KTMH2.mjs";import{c as li}from"https://app.framerstatic.com/chunk-3UVLKWUZ.mjs";import"https://app.framerstatic.com/chunk-POQKH4YA.mjs";import{e as ia,g as aa,i as ge}from"https://app.framerstatic.com/chunk-52AHQOTG.mjs";import"https://app.framerstatic.com/chunk-AUNF3KWQ.mjs";import{p as ue,r as Rt}from"https://app.framerstatic.com/chunk-NEFK4M7X.mjs";import"https://app.framerstatic.com/chunk-JFRKIM2Y.mjs";import{b as se,d as no,e as st,f as Co,i as xe,m as kr,o as pi}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{Bc as mi,a as te,ad as qe,b as h}from"https://app.framerstatic.com/chunk-NIDOI5EE.mjs";import"https://app.framerstatic.com/chunk-WDRGG64A.mjs";import{f as ai}from"https://app.framerstatic.com/chunk-WWFRYK5U.mjs";import{F as ii,da as ro,ea as Bt,i as wo,l as ae,p as Io}from"https://app.framerstatic.com/chunk-35MJ64JF.mjs";import{a as p,b as oo}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as Uo}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{e as g,f as oe,g as re,h as C,i as E,j as y,k as At,l as D,m as ho}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var Sl=g(h()),Bf={BooleanControlPropRow:Jo,EnumControlPropRow:lo,StringControlPropRow:co};function vl({children:r}){return(0,Sl.jsx)(ks.Provider,{value:Bf,children:r})}var Qr="data-chrome";function El(r){return r instanceof HTMLElement?r.closest(`[${Qr}]`)!==null:!1}var en="data-floating-canvas-chrome";function Tl(r){return r instanceof Element?r.closest(`[${en}]`)!==null:!1}function Nl(){return window}function tn(){return Nl().secureFrameAncestors}function Ht(){k(tn(),"Must have secure frame ancestors.")}var ur=g(te());var Al="chromeHidden_c1gxt05z",Bl="nonHudChromeWrapper_n1sd5akc";var Ct=g(te());var on=g(h());function Dl({collectionItemNode:r,collectionNode:o,controlProp:e,variableId:t,warningMessage:n,onChange:i}){let a=L(),s=o.getPropertyControls(a.tree)[t];return k(s?.type==="boolean"),(0,on.jsx)(H,{title:s.title??"",warningMessage:n,children:(0,on.jsx)(ll,{control:s,controlProp:e,fieldId:t,itemId:r.id,onChange:f=>{le(f)&&i(t,f)}})})}var Rl="onPageCMSFieldsModal_o1kosemn",kl="onPageCMSFieldsModalHeader_o1tcokht",Ml="onPageCMSFieldsModalBody_o11jr4ka",Rf=1,Ol=ge.panelPadding+Rf,Vl="onPageCMSFieldsModalButtonContainer_oaqx903",Qo="button_b1gqim6f";var Ll="wrapper_wje69dc",_l="input_i1rqgchl",Wl="icon_ixghur2",Hl="collectionInputHeight_c1d0unc6";var rn=g(h());function zl({collectionNode:r,controlProp:o,variableId:e,warningMessage:t,onChange:n}){let i=L(),l=r.getPropertyControls(i.tree)[e];k(l?.type==="collectionreference");let s=Ai(l,o);k(!V(s),"Variables are not supported");let f=l.dataIdentifier;function m(c){n(e,{type:"collectionreference",value:c})}return(0,rn.jsx)(H,{title:l.title??"",warningMessage:t,children:(0,rn.jsx)(Ks,{large:!0,value:s,onChange:m,className:_l,dataIdentifier:f,wrapperClassName:ui(Ll,Hl),iconClassName:Wl})})}var nn=g(h());function jl({collectionItemNode:r,collectionNode:o,controlProp:e,variableId:t,warningMessage:n,onChange:i}){let a=L(),s=o.getPropertyControls(a.tree)[t];return k(s?.type==="color"),(0,nn.jsx)(H,{title:s.title??"",warningMessage:n,children:(0,nn.jsx)(cl,{control:s,controlProp:e,fieldId:t,itemId:r.id,onChange:f=>{le(f)&&i(t,f)},ColorPickerPopoutComponent:Rs})})}var an=g(h());function ql({collectionItemNode:r,collectionNode:o,controlProp:e,variableId:t,warningMessage:n,onChange:i}){let a=L(),s=o.getPropertyControls(a.tree)[t];return k(s?.type==="date"),(0,an.jsx)(H,{title:s.title??"",warningMessage:n,children:(0,an.jsx)(fl,{control:s,controlProp:e,fieldId:t,itemId:r.id,onChange:f=>{le(f)&&i(t,f)},required:!1})})}var sn=g(h());function Kl({collectionItemNode:r,collectionNode:o,controlProp:e,variableId:t,warningMessage:n,onChange:i}){let a=L(),s=o.getPropertyControls(a.tree)[t];return k(s?.type==="enum"),(0,sn.jsx)(H,{title:s.title??"",warningMessage:n,children:(0,sn.jsx)(ml,{control:s,controlProp:e,fieldId:t,itemId:r.id,onChange:f=>{le(f)&&i(t,f)}})})}var ln=g(h());function Gl({collectionItemNode:r,collectionNode:o,controlProp:e,variableId:t,warningMessage:n,onChange:i}){let a=L(),s=o.getPropertyControls(a.tree)[t];if(k(s?.type==="file"),k(!Me(e?.value),"Dynamic values are not supported within required field validation"),e&&e?.type!=="file")return null;let m=(e?.value??"").split(".").pop(),c=!m||s.allowedFileTypes.length===0||s.allowedFileTypes.includes(m);return(0,ln.jsx)(H,{title:s.title??"",warningMessage:n,showWarningTint:!c,children:(0,ln.jsx)(pl,{control:s,controlProp:e,fieldId:t,itemId:r.id,onChange:u=>{le(u)&&i(t,u)},reset:()=>{i(t,{type:"file",value:void 0})}})})}var dn=g(h());function Yl({collectionItemNode:r,collectionNode:o,controlProp:e,variableId:t,onChange:n}){let i=L(),a=ys(d=>{let w=d(e);w&&n(t,w)}),s=o.getPropertyControls(i.tree)[t];k(s?.type==="array"),k(!e||Si(e));let f=Ps(e,s,!0),m=bs(e,s,!0),u=Go(f??m,s);return(0,dn.jsx)(H,{title:s.title??"",warningMessage:u,children:(0,dn.jsx)(ul,{collectionId:o.id,control:s,fieldId:t,controlProp:e,itemId:r.id,onChange:a,required:!1})})}var cn=g(h());function $l({collectionItemNode:r,collectionNode:o,controlProp:e,variableId:t,warningMessage:n,onChange:i}){let a=L(),s=o.getPropertyControls(a.tree)[t];return k(s?.type==="responsiveimage"),(0,cn.jsx)(H,{title:s.title??"",warningMessage:n,children:(0,cn.jsx)(gl,{control:s,controlProp:e,fieldId:t,itemId:r.id,onChange:f=>{let m=f(e);le(m)&&i(t,m)},reset:()=>{let f={type:"image",value:void 0};i(t,f)}})})}var fn=g(h());function Xl({collectionItemNode:r,collectionNode:o,controlProp:e,variableId:t,warningMessage:n,onChange:i}){let a=L(),s=o.getPropertyControls(a.tree)[t];return k(s?.type==="link"),(0,fn.jsx)(H,{title:s.title??"",warningMessage:n,children:(0,fn.jsx)(yl,{control:s,controlProp:e,fieldId:t,itemId:r.id,onChange:f=>{le(f)&&i(t,f)},reset:()=>{let f={type:"link",value:void 0};i(t,f)}})})}var Zl="inputWrapper_i4uywus";var mn=g(h());function Jl({collectionNode:r,controlProp:o,variableId:e,warningMessage:t,onChange:n}){let i=L(),l=r.getPropertyControls(i.tree)[e];p(l?.type==="multicollectionreference");let s=l.dataIdentifier,f=Bi(l,o)??[];return p(!V(f),"Variables are not supported"),(0,mn.jsx)(H,{title:l.title??"",warningMessage:t,children:(0,mn.jsx)(il,{large:!0,value:f,onChange:m=>{n(e,{type:"multicollectionreference",value:m})},wrapperClassName:Zl,dataIdentifier:s})})}var pn=g(h());function Ql({collectionItemNode:r,collectionNode:o,controlProp:e,variableId:t,warningMessage:n,onChange:i}){let a=L(),s=o.getPropertyControls(a.tree)[t];return k(s?.type==="number"),(0,pn.jsx)(H,{title:s.title??"",warningMessage:n,children:(0,pn.jsx)(hl,{control:s,controlProp:e,fieldId:t,itemId:r.id,onChange:f=>{le(f)&&i(t,f)}})})}var er=g(h()),ed=["left","right","auto-vertical"];function td({collectionNode:r,collectionItemNode:o,controlProp:e,variableId:t,onChange:n,warningMessage:i}){let a=L(),s=r.getPropertyControls(a.tree)[t];p(s?.type==="richtext");let f=e&&li(e.value)?e.value:void 0,m=d=>{n(t,{type:s.type,value:d})},c=$o(()=>lt(Eo)),u=Rt("pasteMarkdown");return(0,er.jsx)(H,{title:s.title??"",warningMessage:i,children:u?(0,er.jsx)(Xo,{enabled:!0,schema:c,compactTagSelector:!0,defaultValue:f??"",onChange:m,scopeType:"ContentManagement",onUnsavedChange:ct,popoverAttachmentEdge:ed,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0},o.id):(0,er.jsx)(Zo,{enabled:!0,supportsEmbeds:!0,supportsMedia:!0,compactTagSelector:!0,defaultValue:f??"",onChange:m,scopeType:"ContentManagement",onUnsavedChange:ct,popoverAttachmentEdge:ed,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0},o.id)})}var tr=g(h());function od({collectionNode:r,collectionItemNode:o,controlProp:e,variableId:t,onChange:n,warningMessage:i}){let a=L(),s=r.getPropertyControls(a.tree)[t];p(s?.type==="string");let f=e&&se(e.value)?e.value:void 0,m=s.placeholder,c=s.defaultValue??"",u=f??c,d=w=>{n(t,{type:s.type,value:w})};return(0,tr.jsx)(H,{title:s.title??"",warningMessage:i,children:s.displayTextArea?(0,tr.jsx)(Ua,{value:u,onChange:d,constantChange:!0,placeholder:m,minRows:10,maxRows:30,className:Il},o.id):(0,tr.jsx)(Ca,{type:s.obscured?"password":"text",value:u,onChange:d,placeholder:m,constantChange:!0,className:dl})})}var O=g(h());function nd({fieldIdsToShow:r,requiredFieldsOnly:o,collectionItemId:e,collectionNodeId:t}){let[n,i]=(0,Ct.useState)(!0),[a,l]=(0,Ct.useState)(()=>new Map),s=a.size>0,f=x(),{treeStore:m,projectStore:c,modalStore:u}=f.stores,d=e!==f.stores.canvasStore.temporaryCollectionItemNodeId,w=m.tree.getNodeWithTrait(t,Dt),I=m.tree.getNodeWithTrait(e,Je);(0,Ct.useEffect)(()=>{(!I||!w||I.parentid!==w.id)&&u.dismiss()},[I,w,u]);let U=o||d,T=()=>{for(let[ee,j]of a)m.tree.current(I)?.setControlProp(ee,j);U?d?(m.tree.current(I)?.set({privateToUserId:void 0}),c.commitTreeAndSend()):f.stores.canvasStore.saveTemporaryCollectionItem():c.commitTreeAndSend(),u.dismissAll()},S=()=>{if(!zo()){if(d&&P.size>0){i(!1);return}T()}},P=Lf({collectionNode:w||void 0,collectionItemNode:I||void 0,tempControlProps:a,fieldIdsToShow:r});function F(ee){let M=w?.getPropertyControls(m.tree)?.[ee];if(!M)return;let Xe=P.get(ee);if(!(Xe?.type==="required"&&!(d&&!n)))return Go(Xe,M)}let b=(ee,j)=>{p(I,"CollectionItemNode must be present");let M=I.getControlProp(ee);l(Xe=>M?.value===j.value?ro.remove(Xe,ee):Co(M?.value)&&Co(j.value)&&es(M.value,j.value)?ro.remove(Xe,ee):rd(M)&&rd(j)?ro.remove(Xe,ee):ro.set(Xe,ee,j))},N=()=>{if(!s){Ee();return}u.push({type:"Confirmation",title:"Unsaved Changes",description:"Are you sure that you want to discard your new item?",interactionRequired:!0,onConfirm:()=>Ee(),cancelLabel:"Continue Editing",confirmLabel:"Discard Item",dismissVariant:"primary",variant:"destructiveSecondary",cancelOnEnter:!0,confirmOnEnter:!1,source:"on_page_hud",buttonDirection:"column",hasBackdrop:!0})},Ee=()=>{I&&(m.tree.remove(I.id),c.commitTreeAndSend(),u.dismiss())},$e=()=>{if(d){N();return}if(o){u.dismiss();return}T()},ze=()=>{if(d){N();return}u.dismiss()};return(0,O.jsxs)(Mt,{hasBackdrop:!0,className:Rl,visible:r.length>0,onDismiss:$e,onConfirm:S,children:[(0,O.jsx)(Ot,{separator:!0,title:d?"New Item":o?"Required Fields":"All Fields",className:kl,children:(0,O.jsx)(Vt,{onDismiss:ze})}),(0,O.jsxs)(Na,{className:Ml,children:[(0,O.jsx)(ba,{size:0}),r.map(ee=>{if(!w||!I)return null;let j=w.getVariable(ee);if(!j)return null;let M=a.get(ee)??I.getControlProp(ee);return(0,O.jsx)(Vf,{variable:j,collectionItemNode:I,collectionNode:w,controlProp:M,onChange:b,getWarningMessage:F},ee)})]}),(0,O.jsx)(Oo,{displayDivider:!1,paddingTop:Ol,className:Vl,children:(0,O.jsxs)(sa,{children:[o?(0,O.jsx)(K,{bold:!0,onClick:ze,className:Qo,children:(0,O.jsx)(Qe,{children:"Cancel"})}):(0,O.jsx)(K,{bold:!0,onClick:ze,className:Qo,children:(0,O.jsx)(Qe,{children:s?"Discard":"Cancel"})}),(0,O.jsx)(K,{bold:!0,type:"submit",variant:"primary",className:Qo,enabled:o?P.size===0:s,children:(0,O.jsx)(Qe,{children:"Save"})})]})})]})}function Vf({variable:r,collectionItemNode:o,collectionNode:e,controlProp:t,onChange:n,getWarningMessage:i}){let a=r.type;switch(a){case"slug":return ao(r)?(0,O.jsx)(wl,{collectionNode:e,collectionItemNode:o,controlProp:t,onChange:n,variable:r,warningMessage:i(r.id)}):null;case"string":return(0,O.jsx)(od,{collectionNode:e,collectionItemNode:o,controlProp:t,variableId:r.id,onChange:n,warningMessage:i(r.id)});case"richtext":return(0,O.jsx)(td,{collectionNode:e,collectionItemNode:o,controlProp:t,variableId:r.id,onChange:n,warningMessage:i(r.id)});case"link":return(0,O.jsx)(Xl,{collectionItemNode:o,collectionNode:e,controlProp:t,variableId:r.id,warningMessage:i(r.id),onChange:n});case"image":return(0,O.jsx)($l,{collectionItemNode:o,collectionNode:e,controlProp:t,variableId:r.id,warningMessage:i(r.id),onChange:n});case"array":return(0,O.jsx)(Yl,{collectionItemNode:o,collectionNode:e,controlProp:t,variableId:r.id,onChange:n});case"multicollectionreference":return(0,O.jsx)(Jl,{collectionNode:e,controlProp:t,variableId:r.id,warningMessage:i(r.id),onChange:n});case"collectionreference":return(0,O.jsx)(zl,{collectionNode:e,controlProp:t,variableId:r.id,warningMessage:i(r.id),onChange:n});case"file":return(0,O.jsx)(Gl,{collectionItemNode:o,collectionNode:e,controlProp:t,variableId:r.id,warningMessage:i(r.id),onChange:n});case"date":return(0,O.jsx)(ql,{collectionItemNode:o,collectionNode:e,controlProp:t,variableId:r.id,warningMessage:i(r.id),onChange:n});case"number":return(0,O.jsx)(Ql,{collectionItemNode:o,collectionNode:e,controlProp:t,variableId:r.id,warningMessage:i(r.id),onChange:n});case"boolean":return(0,O.jsx)(Dl,{collectionItemNode:o,collectionNode:e,controlProp:t,variableId:r.id,warningMessage:i(r.id),onChange:n});case"enum":return(0,O.jsx)(Kl,{collectionItemNode:o,collectionNode:e,controlProp:t,variableId:r.id,warningMessage:i(r.id),onChange:n});case"color":return(0,O.jsx)(jl,{collectionItemNode:o,collectionNode:e,controlProp:t,variableId:r.id,warningMessage:i(r.id),onChange:n});default:si(a)}}function Lf({collectionNode:r,collectionItemNode:o,tempControlProps:e,fieldIdsToShow:t}){let n=x(),i=v(()=>n.stores.treeStore.tree,[]),a=xs(r,o);return(0,Ct.useMemo)(()=>{let l=new Map;if(!r||!o)return l;for(let s of t){let f=r.getVariable(s);if(!f)continue;let c=r.getPropertyControls(i)[s];if(!c)continue;let u=e.get(s)??o.getControlProp(s),d=a.get(s),w;(bo(f)||ao(f))&&(w=qo(f,r.variables,o));let I=Ko(f.type,c,u,w,void 0,vo(f),d);I&&l.set(s,I)}return l},[r,o,t,a,i,e])}function rd(r){return!r||pi(r.value)?!0:se(r.value)?La(r.value):Co(r.value)?r.value.length===0:!1}var rr=g(te());var id="editorContainer_e1zu74n";var sd=g(h());function ad({initialHtml:r,onContentChange:o,onEscape:e}){let t=(0,rr.useRef)(null);return(0,rr.useEffect)(()=>{let n;async function i(){let{baseKeymap:a,chainCommands:l,dropCursor:s,gapCursor:f,history:m,keymap:c,redo:u,undo:d,undoInputRule:w}=await Lt(),I=ue.isOn("pasteMarkdown")?(F,b,N)=>Ao(F,b,N):(F,b,N)=>Bo(F,N),U=lt(So),T=I(r,U,{plugins:[m(),c({"Mod-z":l(w,d),"Mod-Shift-z":u,"Shift-Enter":Lo(U),"Mod-b":Xr(U.marks.bold),"Mod-i":Xr(U.marks.italic),"Shift-Tab":Wa(U.nodes.listItem),Tab:l(Ha(U.nodes.listItem),()=>!0),Backspace:l(w,_o(U)),Escape:()=>(e?.(),!!e)}),c(a),s({color:"var(--framer-color-text)",width:2}),f(),Wo()]}),S,P=new Mi(null,{state:T,editable:()=>!0,dispatchTransaction:F=>{let b=P.state.apply(F);if(P.updateState(b),S!==b.doc){let N=ue.isOn("pasteMarkdown")?To(b.doc,U):No(b.doc);o(N),S=b.doc}}});t.current&&(t.current.innerHTML="",t.current.appendChild(P.dom)),n=P}return i(),()=>n?.destroy()},[r,o,e]),(0,sd.jsx)("div",{ref:t,className:id})}function ot({tree:r,webPageNodeId:o}){let e=r.getNodeWithTrait(o,xi);if(e?.loaded)return e.loaded;e?.load().catch(ae)}function me({screenWidth:r,tree:o,webPageNodeId:e}){let n=ot({tree:o,webPageNodeId:e})?.getBreakpointValues(),i=Ni(n,r);return o.get(i)}function Ke(r,o,e){let t=e.temporaryCollectionItemNodeId??r.collectionItemNodeId;return o.tree.getNodeWithTrait(t,Je)??void 0}function zt(r,o,e){let t=Ke(r,o,e);if(t)return o.tree.getNodeWithTrait(t.parentid,Dt)??void 0}var $=class{constructor(o){this.engine=o;y(this,"scheduler");this.scheduler=o.scheduler}};var Wf=/^(?<hashes>#{1,6})\s$/u,ye=class r extends ${constructor(e,t,n,i="none"){super(e);this.nodeId=t;this.renderId=n;this.eventSource=i;y(this,"handleOnFocus",()=>this.proseMirrorEditor?.controls.handleOnFocus());y(this,"handleOnBlur",()=>this.proseMirrorEditor?.controls.handleOnBlur());y(this,"proseMirrorEditor",null);y(this,"hasTextFitViewBox",!1);this.engine.beginUndoGroup(),this.start()}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}update(){let e=this.getRichTextNode();if(!e||!r.supportsNode(e)){this.engine.exitTool();return}if(!e.textFitViewBoxSize||this.hasTextFitViewBox)return;let t=Qi(this.engine.tree,e);this.engine.stores.projectStore.commitTreeAndSend(),t&&(this.hasTextFitViewBox=!0)}async stop(){let e=this.getRichTextNode();e&&(e.cache.isEditable=!1),this.proseMirrorEditor?.destroy(),this.proseMirrorEditor=null,this.engine.endUndoGroup(),this.engine.stores.toolStore.proseMirrorView=null,this.engine.stores.toolStore.nodeInTextEditorId=null}start(){let e=this.getRichTextNode();if(!e)return;this.hasTextFitViewBox=Xi(this.engine.tree,e),this.engine.stores.projectStore.commitTreeAndSend();let t=Ho(this.engine.tree,e);if(t.length===0){this.init();return}at.loadFonts(t).catch(ae).finally(()=>this.init())}init(){this.startAsync().catch(e=>{ae(e),this.engine.exitTool()})}async startAsync(){let e=this.getRichTextNode();if(!e)return this.engine.exitTool();this.proseMirrorEditor=await this.createProseMirrorEditor(e),e.cache.isEditable=!0,this.engine.stores.toolStore.proseMirrorView=this.proseMirrorEditor.view}async createProseMirrorEditor(e){let{baseKeymap:t,chainCommands:n,createParagraphNear:i,Decoration:a,DecorationSet:l,dropCursor:s,EditorView:f,ellipsis:m,emDash:c,gapCursor:u,history:d,InputRule:w,inputRules:I,keymap:U,liftEmptyBlock:T,liftListItem:S,newlineInCode:P,redo:F,sinkListItem:b,splitBlock:N,splitListItem:Ee,toggleMark:$e,undo:ze,undoInputRule:ee}=await Lt(),j=this.engine,M=lt(So),Xe=n(Ee(M.nodes.listItem),P,i,T,ja(M),za(M),(Q,q)=>N(Q,q&&(G=>{let it=Q.selection,Tt=this.getRichTextNode();p(Tt,"RichTextNode not found");let je=it.$from.node(1);if(!Hr(je)||!(it.$to.parentOffset===it.$to.parent.content.size))return q(G);let Fe={...je.attrs},yt=Wr(je)&&Fe.tag!=="p",to=G.mapping.map(Q.selection.to),Nt=Q.selection.$from.marks();if(yt){let Ze=Tt.getNodeTextStylePreset(j.tree,"p")??qr(j.tree,"p")??zr.createDefault("p");Kr(j,Ze),Tt.setNodeTextStylePreset(Ze),j.stores.projectStore.commitTreeAndSend(),Fe.textStylePreset=Ze.id,Fe.tag="p",Fe.inlineStyles={},Fe.blockStyles={}}else{let Ze=Nt.find(Di);Fe.inlineStyles={...Fe.inlineStyles,...Ze?.attrs.inlineStyles}}G.setNodeMarkup(to-1,void 0,Fe),G.setStoredMarks(Nt),yt&&G.removeStoredMark(M.marks.inlineStyles),q(G)})));function oi(){return j.exitTool(),!0}p(!V(e.htmlContent),"Can't edit rich text node when htmlContent variable is assigned"),p(!V(e.textContent),"Can't edit rich text node when textContent variable is assigned");let Rr=()=>{let Q=this.getRichTextNode();p(Q,"RichTextNode not found");let q=Q.getNodeInlineCodeStylePreset(j.tree)??Yi(j.tree)??new ji;return $i(j,q),Q.setNodeInlineCodeStylePreset(q),q.id},ri=(ue.isOn("pasteMarkdown")?(Q,q,G)=>Ao(Q,q,G):(Q,q,G)=>Bo(Q,G))(e.html,M,{plugins:[d(),U({"Mod-z":n(ee,ze),"Mod-Shift-z":F,"Shift-Enter":Lo(M),"Mod-b":$e(M.marks.bold),"Mod-i":$e(M.marks.italic),"Shift-Tab":S(M.nodes.listItem),Tab:n(b(M.nodes.listItem),()=>!0),Backspace:n(ee,_o(M)),Escape:oi,Enter:Xe,"Mod-Shift-c":$e(M.marks.inlineCode,{get inlineCodeStylePreset(){return Rr()}})}),U(t),s({color:aa.cmsRichTextDropCursor,width:ge.richTextDropCursor}),u(),Wo(),Xa({engine:this.engine,schema:M,nodeId:this.nodeId,getRichTextNode:()=>this.getRichTextNode()}),I({rules:[c,m,new w(Wf,(Q,q,G,it)=>{let Tt=Q.doc.resolve(G),je=Tt.node(1),yo=Tt.before(1);if(!Hr(je))return null;let Fe=Q.tr,yt="h"+(q.groups?.hashes?.length||1),to=this.getRichTextNode();p(to,"RichTextNode not found");let Nt=to.getNodeTextStylePreset(j.tree,yt)??qr(j.tree,yt)??zr.createDefault(yt),Ze=Nt.id;return Kr(j,Nt),to.setNodeTextStylePreset(Nt),j.stores.projectStore.commitTreeAndSend(),Wr(je)||Fe.removeMark(yo,yo+je.nodeSize,M.marks.inlineStyles),Fe.delete(G,it),Fe.setNodeMarkup(yo,M.nodes.textBlock,{...je.attrs,blockStyles:Ze?{}:je.attrs.blockStyles,inlineStyles:Ze?{}:je.attrs.inlineStyles,textStylePreset:Ze,tag:yt}),Fe}),qa(M),Ka(M)]}),..._a({markType:M.marks.inlineCode,attrs:{get inlineCodeStylePreset(){return Rr()}}})]}),ni,nt=new f(null,{state:ri,dispatchTransaction:Q=>{let q=this.getRichTextNode();p(q,"Node should not be null");let G=nt.state.apply(Q);if(nt.updateState(G),G=Zi(G,nt,q),ni!==G.doc){let it=ue.isOn("pasteMarkdown")?To(G.doc,M):No(G.doc);q.html!==it&&(r.updateNodeWithBreakpointAwareness({engine:this.engine,html:it,node:q}),Ji(q,nt)),ni=G.doc}this.engine.stores.projectStore.commitTreeAndSend()}});return{controls:{handleOnFocus(){nt.setProps({decorations(){}})},handleOnBlur(){nt.setProps({decorations(Q){let q=Q.selection;if(q.from!==q.to)return document.getSelection()?.removeAllRanges(),l.create(Q.doc,[a.inline(q.from,q.to,{class:"selection",nodeName:"mark"})])}})}},destroy:()=>nt.destroy(),state:ri,view:nt}}static updateNodeWithBreakpointAwareness({engine:e,node:t,html:n,breakpointNode:i}){let{tree:a,stores:l}=e,{routeStore:s,canvasStore:f,treeStore:m}=l;i??=me({screenWidth:f.screenWidth,tree:m.tree,webPageNodeId:s.webPageNodeId});let c=t.getPrimaryId(),u=!Ui(i)||Ei(i)||!c,d=!Do(a,t,"html"),w=a.getNodeWithTrait(c,A);if(p(w,`originalNode with id ${c} must exist`),u||d){w.set({html:n});return}if(t.getTextContent()===w.getTextContent()){w.set({html:qi(w.html,Ki(n))});return}t.set({html:n},a,!1,!1)}static supportsNode(e){return A(e)&&!e.htmlContent&&!e.textContent}};function he(){let r=x();return v(()=>ot({tree:r.stores.treeStore.tree,webPageNodeId:r.stores.routeStore.webPageNodeId}),[])}function ld(){let r=x(),{routeStore:o,treeStore:e,canvasStore:t}=r.stores;return et(()=>Ke(o,e,t),[],[o,e,t])}function dd(){let r=x(),{routeStore:o,treeStore:e,canvasStore:t}=r.stores;return et(()=>zt(o,e,t),[],[o,e,t])}var be=g(te());var cd="modal_m168h77v";var we=g(h());function fd({richTextNodeId:r}){let o=x(),e=he(),[t,n]=(0,be.useState)(()=>{let w=me({screenWidth:o.stores.canvasStore.screenWidth,tree:o.stores.treeStore.tree,webPageNodeId:o.stores.routeStore.webPageNodeId});return p(w,"activeOnPageBreakpointNode must exist"),w.id}),i=(0,be.useRef)(new Map),a=(0,be.useMemo)(()=>{let w=o.stores.treeStore.tree.getNodeWithTrait(r,A);return w?w.getPrimaryId():r},[r]),l=(0,be.useCallback)(()=>o.stores.scopeStore.active.getTopLevelReplicaVariants().find(({id:w})=>t===w),[t]),s=(0,be.useCallback)(()=>{let w=l();if(!w)return;let I=so(w.id,a),U=o.stores.treeStore.tree.get(I);return A(U)?U:void 0},[l,a]),f=v(()=>o.stores.scopeStore.active.getPrimaryVariant().id,[]),m=(0,be.useMemo)(()=>{let w=i.current.get(t);if(w!==void 0)return w;if(t===f){let I=o.stores.treeStore.tree.getNodeWithTrait(a,A);return p(I,"originalNode should exist"),I.html}return s()?.html??""},[s,f,t,a]),c=(0,be.useCallback)(w=>i.current.set(t,w),[t]),u=(0,be.useCallback)(()=>{o.exitTool(),o.stores.modalStore.dismiss()},[]),d=(0,be.useCallback)(()=>{let w=o.stores.scopeStore.active.getPrimaryVariant(),I=i.current.get(w.id);if(I!==void 0){let U=o.stores.treeStore.tree.getNodeWithTrait(a,A);p(U,`originalNode with id ${a} must exist`),U.html!==I&&U.set({html:I})}o.stores.scopeStore.active.getTopLevelReplicaVariants().forEach(U=>{let T=i.current.get(U.id);if(T===void 0)return;let S=so(U.id,a),P=o.stores.treeStore.tree.get(S);A(P)&&P.html!==T&&ye.updateNodeWithBreakpointAwareness({breakpointNode:U,engine:o,html:T,node:P})}),i.current.clear(),o.stores.projectStore.commitTreeAndSend(),u()},[u,a]);return(0,we.jsxs)(Mt,{visible:!0,hasBackdrop:!0,onDismiss:u,className:cd,children:[(0,we.jsx)(Ot,{separator:!0,title:"Responsive Text",children:(0,we.jsx)(Vt,{onDismiss:u})}),(0,we.jsxs)(Pe,{gap:ge.inputSpacing,paddingTop:ge.modalPadding,children:[(0,we.jsx)(Ta,{children:e?.getTopLevelVariants().map(w=>(0,we.jsx)(Ea,{identifier:w.id,title:w.resolveValue("name")??w.id,selected:t===w.id,onSelect:n},w.id))}),(0,we.jsx)(ad,{initialHtml:m,onContentChange:c,onEscape:u})]}),(0,we.jsxs)(Oo,{displayDivider:!0,children:[(0,we.jsx)(K,{bold:!0,onClick:u,variant:"default",children:(0,we.jsx)(Qe,{children:"Cancel"})}),(0,we.jsx)(K,{bold:!0,onClick:d,variant:"primary",children:(0,we.jsx)(Qe,{children:"Save"})})]})]})}var nr=g(te());var md="modal_m1cvfiap",pd="form_f1nz04q2",ud="scroll_syo0l7n",gd="width100_w9541mz",un="editor_e73gufq";var mt=g(h()),yd=["left","right","auto-vertical"];function wd({controlKey:r,nodeId:o}){let e=L(),t=()=>{e.stores.modalStore.dismiss()},n=et(()=>{let d=e.stores.treeStore.tree.get(o);return!Je(d)&&!Oe(d)?null:d},[o],["Tree"]),i=et(()=>{let u=e.tree.getScopeNodeFor(n);return u?Ra(u):null},[n],["Tree"]),a=et(()=>{if(Je(n)){let u=n?.parentid,d=e.stores.treeStore.tree,w=d.getNodeWithTrait(u,Dt);if(!w)return null;let U=w.getPropertyControls(d)[r];return U?.type==="richtext"?U:null}if(Oe(n)){let u=ne.reactComponentForIdentifier(n.codeComponentIdentifier);if(!u)return null;let d=u.properties[r];return d?.type==="richtext"?d:null}return null},[r,n],["Tree","ActiveBundle"]),l=(0,nr.useMemo)(()=>{if(!n)return"";let u=hd(n,r);return se(u?.value)?u.value:""},[n,r]),s=!!i&&!!n&&a?.type==="richtext",f=u=>{if(!n)return;let d=e.stores.treeStore.tree.current(n);if(!d)return;let w,I=hd(n,r);I?w={...I,value:u}:w={type:"richtext",value:u},Je(d),d.setControlProp(r,w),p(na(e),"Only on-page engine can commit tree"),e.stores.projectStore.commitTreeAndSend()};(0,nr.useEffect)(()=>{s||e.stores.modalStore.dismiss()},[s]);let m=$o(()=>lt(Po(n)?Eo:Oi)),c=Rt("pasteMarkdown");return s?(0,mt.jsxs)(Mt,{visible:!0,hasBackdrop:!0,onDismiss:t,className:md,formClassName:pd,children:[(0,mt.jsx)(Ot,{separator:!0,title:a.title??"Unknown",className:gd,children:(0,mt.jsx)(Vt,{onDismiss:t})}),(0,mt.jsx)(Fa,{className:ud,children:c?(0,mt.jsx)(Xo,{enabled:!0,schema:m,className:un,defaultValue:l,onChange:f,scopeType:i,onUnsavedChange:ct,popoverAttachmentEdge:yd,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0}):(0,mt.jsx)(Zo,{enabled:!0,supportsEmbeds:Po(n),supportsMedia:Po(n),className:un,defaultValue:l,onChange:f,scopeType:i,onUnsavedChange:ct,popoverAttachmentEdge:yd,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0})})]}):null}function hd(r,o){if(Je(r)){let e=r.getControlProp(o);return e?.type==="richtext"&&se(e.value)?e:null}if(Oe(r)){let e=ne.reactComponentForIdentifier(r.codeComponentIdentifier);if(!e)return null;let n=r.getControlProps(e.properties)[o];if(n?.type==="richtext"&&se(n.value))return n}return null}var fo=g(h()),jf={AcquireAddonModal:null,AcquireAdvancedAnalyticsTrialModal:null,AddToLibrary:null,BatchTranslate:null,CodeFileCreation:null,CompleteSignup:null,ComponentIsolationModal:null,Confirmation:tl,ConfirmBatchTranslateAll:null,ConfirmDefaultLanguage:null,ConfirmDeleteCollectionItems:null,ConfirmDeleteCustomCode:null,ConfirmDestructiveFeedbackAction:null,ConfirmDraftCollectionItem:null,ConfirmDraftLocale:null,ConfirmDraftPage:null,ConfirmPublishAbTest:null,ConfirmPublishDraftCollectionItem:null,ConfirmPublishDraftLocale:null,ConfirmPublishDraftPage:null,ConfirmRemoveTriggerEvent:null,ConfirmUpdatingAbVariants:null,ConvertToCMSPage:null,CreateAbTest:null,CreateComponent:null,CreateLayoutTemplate:null,CreateManagedCollection:null,CreateTeam:null,CustomBreakpoint:null,DashboardAddHeader:null,DashboardAddRedirect:null,DashboardAddRewrite:null,DashboardEditHeader:null,DashboardEditRedirect:null,DashboardEditRewrite:null,DeleteCodeFile:null,DeleteCustomFont:null,DeleteEntityFolder:null,DeleteFile:null,DeleteMultipleCodeFiles:null,DeleteMultipleEntityFolders:null,DeprecatedDrafts:null,DuplicateProjectWithVersion:null,DuplicateWebPage:null,EditCustomCode:null,FigmaImportTutorial:null,FlexToYearly:null,ImageCrop:ol,ImageFocalPoint:rl,ImportFigma:null,ImportRedirects:null,LoadingFullDocument:null,LocaleReady:null,LocaleSettings:null,LocalizationGlossary:null,None:null,NudgePreferences:null,OnPageCMSFieldsModal:nd,OnPageRichTextEditor:wd,OnPageRichTextVariantOverride:fd,OverrideFile:null,PasteFromFigma:null,PlanCancellation:null,PluginCustomHTML:null,PluginFromURL:null,PluginWithModePicker:null,PublishModule:null,QuickActions:null,RemoveTeamLibraryModule:null,ReplaceTextStylePreset:null,ReplaceWebPage:null,SelectProjectToUpgrade:null,Shortcuts:null,StopAbTest:null,SubscriptionNotInOrder:null,TransferProject:null,Templates:null,UnlinkComponent:null,UnsavedChanges:null,UnsupportedFileSize:null,UnsupportedFileType:null,UpgradeDocument:null,UpsellEnterprise:null,UpsellFeature:null,Variables:null,VectorImport:null,VectorSetCreation:null,ViewCustomCode:null,Welcome:null};function Id(){let o=x().stores.modalStore.useState(e=>e.stack);return o.map((e,t)=>{if(e.type==="None")return null;let n=jf[e.type];p(n,`Modal is missing: ${e.type}`);let{type:i,...a}=e,l=t===o.length-1,s=e.type+t;return(0,fo.jsx)(ha,{allowFocusTrap:l,children:(0,fo.jsx)(Pa.Provider,{value:hs(i),children:(0,fo.jsx)(xa.Provider,{value:l?"visible":"hidden",children:(0,fo.jsx)(n,{...a})})})},s)})}function Cd({accessStore:r,routeStore:o},e){let t=r.access;p(t.status==="success","Can't open Framer if project access is not successful");let n=e??o.projectLinkNodeId,i=`${Uo().app}/projects/${t.data.projectSlug}?node=${n}`;window.open(`https://www.framer.com/open-in-app?url=${encodeURIComponent(i)}`,"_blank")}var Sd=g(te());var Fd="toolbar_t49i6vy",Ft="button_bjwo6qr",jt="buttonSecondary_b1qwl3y9",xd="mainContentContainer_m1wta5up",Pd="mainContent_m69kutt",gn="secondaryText_sdjdrec",bd="logoIcon_l9efojb";var yn={slug:!0,string:!0,richtext:!0,link:!0,image:!0,array:!0,multicollectionreference:!0,collectionreference:!0,file:!0,date:!0,number:!0,boolean:!0,enum:!0,color:!0};function ir(r){return vs(r).flatMap(t=>{let n=t.type;return yn[n]!==void 0?t.id:[]})}var B=g(h());function Ed(){let r=x(),{routeStore:o,treeStore:e,canvasStore:t,projectStore:n,modalStore:i}=r.stores,a=v(()=>r.stores.canvasStore.finishedEditing,[]),{hasPermanentlyFailed:l}=n.useState(),s=a?.isNewItem?"Page saved":"Site saved",f=ld(),m=dd(),c=(0,Sd.useCallback)(()=>{p(m,"Collection node must exist"),p(f,"Collection item node must exist");let w=ir(m);r.exitTool(),i.set({type:"OnPageCMSFieldsModal",fieldIdsToShow:w,requiredFieldsOnly:!1,source:"on_page_hud",collectionItemId:f.id,collectionNodeId:m.id})},[o,e,i,r,f,m]),u=()=>{i.set({type:"Confirmation",title:"Discard Changes",description:"All changes will be lost. This action cannot be undone.",confirmLabel:"Discard",cancelLabel:"Cancel",variant:"destructive",source:"on_page_hud",onConfirm:()=>{t.discardTemporaryCollectionItem()}})},d=!!f?.privateToUserId;return(0,B.jsx)(B.Fragment,{children:(0,B.jsxs)("div",{className:Fd,children:[d?(0,B.jsxs)(K,{className:Y(Ft,jt),onClick:u,children:[(0,B.jsx)(fa,{}),"Discard Page"]}):(0,B.jsx)(Kf,{finishedEditing:a}),(0,B.jsxs)("div",{className:xd,children:[(0,B.jsx)(vd,{desktopText:"Click to edit",mobileText:"Tap to edit",secondaryText:"Changes are auto-saved",isVisible:!a}),(0,B.jsx)(vd,{desktopText:s,mobileText:s,secondaryText:`A notification was sent to your collaborators. ${a?.isNewItem?"The page":"Changes"} will be visible when the project is published.`,isVisible:!!a})]}),(0,B.jsxs)(Pe,{direction:"row",gap:10,children:[m&&!d&&!m.managedByPlugin&&!a&&(0,B.jsxs)(K,{className:Y(Ft,jt),enabled:!l,onClick:()=>t.createTemporaryCollectionItem(),"aria-label":"Add Page",children:[(0,B.jsx)(ua,{}),(0,B.jsx)(ar,{desktopText:"Add Page",mobileText:"Page"})]}),d&&!l&&(0,B.jsxs)(K,{className:Y(Ft,jt),onClick:c,children:[(0,B.jsx)(Yf,{}),"Show All Fields"]}),a?(0,B.jsxs)(K,{className:Y(Ft,jt),onClick:()=>t.handleDismissFinishEditing(),children:[(0,B.jsx)(Gf,{}),"Go Back to Site"]}):(0,B.jsxs)(K,{variant:"primary",className:Ft,onClick:()=>t.handleFinishEditing(),children:[(0,B.jsx)(ca,{"aria-hidden":"true"}),(0,B.jsx)(ar,{desktopText:"Finish Editing",mobileText:"Done"})]})]})]})})}function vd({desktopText:r,mobileText:o,secondaryText:e,isVisible:t}){return(0,B.jsx)(mi,{children:t&&(0,B.jsxs)(qe.div,{className:Pd,initial:{marginTop:10,opacity:0},animate:{marginTop:0,opacity:1},exit:{marginTop:-10,opacity:0},children:[(0,B.jsx)(ar,{desktopText:r,mobileText:o}),(0,B.jsx)("span",{className:gn,children:"\xB7"}),(0,B.jsx)("span",{className:gn,children:e})]})})}function ar({desktopText:r,mobileText:o}){let e=Ts(`(max-width: ${ia.tabletSmall}px)`);return!o&&e?null:(0,B.jsx)("span",{children:e?o:r})}function Kf({finishedEditing:r}){let o=x(),e=()=>{Cd(o.stores,r?.isNewItem?r.nodeId:void 0)};return(0,B.jsxs)(K,{className:Y(Ft,jt),onClick:e,"aria-label":"Open in Framer",children:[(0,B.jsx)(ma,{"aria-hidden":"true",className:bd}),(0,B.jsx)(ar,{desktopText:"Open in Framer"})]})}function Gf(){return(0,B.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"9",height:"9",fill:"none",children:[(0,B.jsx)("path",{d:"M 1.5 7.5 L 8 1",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,B.jsx)("path",{d:"M 3 1 L 8 1 L 8 6",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]})}function Yf(){return(0,B.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"11",height:"11",fill:"none",children:[(0,B.jsx)("path",{d:"M1 5.5s1.5-3 4.5-3 4.5 3 4.5 3-1.5 3-4.5 3-4.5-3-4.5-3Z",fill:"transparent",strokeWidth:"1.5",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round"}),(0,B.jsx)("path",{d:"M5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z",fill:"#fff"})]})}var Ve=class extends ${constructor(e,t,n,i){super(e);this.nodeId=t;this.renderId=n;this.eventSource=i}getNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,kt)||this.engine.tree.getNodeWithTrait(this.nodeId,A)}getVariableInfo(){let e=this.getNode();if(!e)return;let t=Lr(e);if(!t)return;let n=e.cache.getRenderInstance(this.renderId);if(n)return _(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,t,"collectionreference",n.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:n,controlProp:i}=t;i.value!==e&&n.setControlProp(t.variableDefinition.id,{...i,value:e})}static supportsNode(e,t,n){let i=Lr(t);if(!i)return!1;let a=t.cache.getRenderInstance(n);return a?!!_(e.tree,e.stores.treeStore.sandboxCollectionData,i,"collectionreference",a.collectionItemId):!1}};var Le=class r extends ${constructor(e,t,n){super(e);this.nodeId=t;this.renderId=n}getCodeComponentNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,Oe)}getEditableControls(){let e=this.getCodeComponentNode();if(e)return r.getEditableControls(this.engine,e,this.renderId)}update(){let e=this.engine,t=this.getCodeComponentNode();(!t||!r.supportsNode(e,t,this.renderId))&&e.exitTool()}stop(){let{modalStore:e}=this.engine.stores;e.stack.some(({type:n})=>n==="OnPageRichTextEditor")&&e.dismissAll()}static getEditableControls(e,t,n){let i=t.cache.getRenderInstance(n);if(!i)return wo();let a=ne.reactComponentForIdentifier(t.codeComponentIdentifier);if(!a)return wo();let l=t.getControlProps(a.properties);if(!l)return wo();let s=[],f=sl(e,t.codeComponentIdentifier);if(Pi(t)&&f)if(bi(t)){let m=_(e.tree,e.stores.treeStore.sandboxCollectionData,t.dynamicVectorSetIdentifier,"vectorsetitem",i.collectionItemId);m&&s.push({type:"collection",controlKey:"dynamicVectorSetIdentifier",variableInfo:m})}else ii(t.codeComponentIdentifier)&&s.push({type:"vectorSetItem",codeComponentIdentifier:t.codeComponentIdentifier});for(let m in l){let c=l[m];if(!c)continue;let u=a.properties[m];if(u){if(c.type==="enum"&&ue.isOn("onPageEnumVariableOnComponentInstanceEditTool")&&!Me(c.value)){p(u.type==="enum");let d=It(u);p(d,"Reduced control prop should not be null"),wt(d,c,u),s.push({type:"component",controlKey:m,controlDescription:u,controlProp:c,reducedControlProp:d})}if(c.type==="string"){if(V(c.value)){let d=_(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,c.type,i.collectionItemId);if(!d)continue;s.push({type:"collection",controlKey:m,variableInfo:d})}else if(!Me(c.value)){p(u.type==="string");let d=It(u);p(d,"Reduced control prop should not be null"),wt(d,c,u),s.push({type:"component",controlKey:m,controlDescription:u,controlProp:c,reducedControlProp:d})}}if(c.type==="richtext"){if(V(c.value)){let d=_(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,c.type,i.collectionItemId);if(!d)continue;s.push({type:"collection",controlKey:m,variableInfo:d})}else if(!Me(c.value)){p(u.type==="richtext");let d=It(u);p(d,"Reduced control prop should not be null"),wt(d,c,u),s.push({type:"component",controlKey:m,controlDescription:u,controlProp:c,reducedControlProp:d})}}if(c.type==="image"){if(V(c.value)){let d=_(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,c.type,i.collectionItemId);if(!d)continue;s.push({type:"collection",controlKey:m,variableInfo:d})}else if(!Me(c.value)){p(u.type==="image"||u.type==="responsiveimage");let d=It(u);p(d,"Reduced control prop should not be null"),wt(d,c,u),s.push({type:"component",controlKey:m,controlDescription:u,controlProp:c,reducedControlProp:d})}}if(c.type==="date"){if(V(c.value)){let d=_(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,"date",i.collectionItemId);if(!d)continue;s.push({type:"collection",controlKey:m,variableInfo:d})}else if(!Me(c.value)){p(u.type==="date");let d=It(u);p(d,"Reduced control prop should not be null"),wt(d,c,u),s.push({type:"component",controlKey:m,controlDescription:u,controlProp:c,reducedControlProp:d})}}if(c.type==="vectorsetitem"){if(V(c.value)){let d=_(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,"vectorsetitem",i.collectionItemId);if(!d)continue;s.push({type:"collection",controlKey:m,variableInfo:d})}else if(!Me(c.value)){p(u.type==="vectorsetitem");let d=It(u);p(d,"Reduced control prop should not be null"),wt(d,c,u),s.push({type:"component",controlKey:m,controlDescription:u,controlProp:c,reducedControlProp:d})}}if(c.type==="link"&&V(c.value)){let d=_(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,"link",i.collectionItemId);if(!d)continue;s.push({type:"collection",controlKey:m,variableInfo:d})}if(c.type==="boolean"&&V(c.value)){let d=_(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,"boolean",i.collectionItemId);if(!d)continue;s.push({type:"collection",controlKey:m,variableInfo:d})}}}return s}static supportsNode(e,t,n){return Oe(t)?r.getEditableControls(e,t,n).length>0:!1}};var _e=class r extends ${constructor(e,t,n,i){super(e);this.nodeId=t;this.renderId=n;this.eventSource=i}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let n=r.getVariableReference(e);if(n)return _(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,n,"date",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:n,variableDefinition:i,controlProp:a}=t;a.value!==e&&(n.setControlProp(i.id,{...a,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();(!t||!r.supportsNode(e,t,this.renderId))&&e.exitTool()}static getVariableReference(e){let t=e.textContent;if(!Fo(t))return;let n=t.startValue;if(V(n))return n}static supportsNode(e,t,n){if(!A(t))return!1;let i=r.getVariableReference(t);if(!i)return!1;let a=t.cache.getRenderInstance(n);return a?!!_(e.tree,e.stores.treeStore.sandboxCollectionData,i,"date",a.collectionItemId):!1}};var We=class r extends ${constructor(e,t,n,i){super(e);this.nodeId=t;this.renderId=n;this.eventSource=i}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}static getVariableReference(e){let t=e.textContent;if(!Fo(t))return;let n=t.startValue;if(V(n))return n}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let n=r.getVariableReference(e);if(n)return _(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,n,"enum",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:n,variableDefinition:i,controlProp:a}=t;a.value!==e&&(n.setControlProp(i.id,{...a,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}static supportsNode(e,t,n){if(!A(t))return!1;let i=r.getVariableReference(t);if(!i)return!1;let a=t.cache.getRenderInstance(n);return a?!!_(e.tree,e.stores.treeStore.sandboxCollectionData,i,"enum",a.collectionItemId):!1}};var He=class r extends ${constructor(e,t,n){super(e);this.nodeId=t;this.renderId=n}update(){let e=this.engine,t=e.tree.get(this.nodeId);(!t||!r.supportsNode(e,t,this.renderId))&&e.exitTool()}static supportsNode(e,t,n){if(!kt(t))return!1;if(V(t.fillImage)){let i=t.cache.getRenderInstance(n);return i?!!_(e.tree,e.stores.treeStore.sandboxCollectionData,t.fillImage,"image",i.collectionItemId):!1}return!Ii(t.fillImage)}};var Td,Nd,sr,hn,pe=class extends(Nd=$,Td=[R()],Nd){constructor(e,t,n,i){super(e);this.nodeId=t;this.renderId=n;this.onCancelWithoutMove=i;D(this,hn,C(sr,8,this,!1)),C(sr,11,this);y(this,"beginState",null);y(this,"beginStates",new Map);y(this,"previousInsertionIndex");y(this,"handleKeyDown",()=>{});y(this,"state");let{mouseStore:a}=this.engine.stores,l=e.tree.get(this.nodeId);k(l,"Node must exist"),this.beginState=Ma(e.tree,l,a.canvasMousePosition),this.beginStates.set(l,this.beginState),this.listenForEscapeKey()}listenForEscapeKey(){this.handleKeyDown=e=>{if(e.key==="Escape"){let t=io(this.beginState?.parent)?this.beginState.parent.getChildrenInVisualOrder().findIndex(n=>n.id===this.nodeId):-1;this.previousInsertionIndex=t,e.preventDefault(),e.stopPropagation(),this.engine.exitTool()}},window.addEventListener("keydown",this.handleKeyDown)}endMoveTool(){this.hasMoved?this.engine.exitTool():this.onCancelWithoutMove()}update(){let{treeStore:e,mouseStore:t,canvasStore:n,routeStore:i}=this.engine.stores,a=e.tree.get(this.nodeId);if(!a)return this.engine.exitTool();let l=me({screenWidth:n.screenWidth,tree:e.tree,webPageNodeId:i.webPageNodeId});if(!t.isMouseDown||!l){requestAnimationFrame(()=>{this.endMoveTool()});return}let f=e.tree,m=t.canvasMousePosition;k(this.beginState,"beginState must be defined"),k(io(this.beginState.parent),"parent must be a stack or grid component");let c=ie.subtract(m,this.beginState.canvasPointUnderMouse);if(this.hasMoved=c.x!==0||c.y!==0,!this.hasMoved)return;let u=this.getPlaceholder(a,this.beginState.parent);if(!u)return;let d=this.beginState.rect,w=ie.add(d,c),U=a.cache.getRenderInstance(this.renderId)?.parentRenderId??this.beginState.parent.id,T=f.convertPointToCanvas(this.beginState.parent,w,void 0,void 0,U);this.state={renderId:this.renderId,nodeId:this.nodeId,rect:{height:u.size.height,left:T.x,top:T.y,width:u.size.width},placeholder:u}}stop(){window.removeEventListener("keydown",this.handleKeyDown);let{treeStore:e}=this.engine.stores,t=e.tree.get(this.nodeId);if(!t)return;let n=io(this.beginState?.parent)?this.beginState.parent.getChildrenInVisualOrder().findIndex(i=>i.id===t.id):-1;this.beginState?.parent&&no(this.previousInsertionIndex)&&this.previousInsertionIndex!==n&&this.engine.tree.moveNode(t,this.beginState.parent.id,this.previousInsertionIndex),this.engine.stores.projectStore.commitTreeAndSend()}getPlaceholder(e,t){if(!e)return null;let n=this.engine.tree.getRect(e,void 0,void 0,void 0,this.renderId),a=e.cache.getRenderInstance(this.renderId)?.parentRenderId??t.id,l={width:n.width,height:n.height},s=ka(this.engine.tree,this.engine.stores.treeStore.layoutCache,this.engine.stores.mouseStore.canvasMousePosition,this.engine.stores.mouseStore.previous.canvasMousePosition,this.beginStates,t,this.engine.tree.convertPointToNode(t,this.engine.stores.mouseStore.canvasMousePosition,void 0,a),this.previousInsertionIndex);return l&&no(s)&&t?(this.previousInsertionIndex!==s&&(this.previousInsertionIndex=s),{renderId:a,nodeId:t.id,size:l,index:s}):null}static supportsNode(e,t){let n=t.parentid?e.tree.get(t.parentid):null;if(!n?.children)return!1;let i=n&&n.children.length>1;return ue.isOn("onPageMoveTool")&&io(n)&&!Li(t)&&i&&!Vi(t)&&!e.stores.canvasStore.temporaryCollectionItemNodeId}};sr=oe(Nd),hn=new WeakMap,E(sr,4,"hasMoved",Td,pe,hn),re(sr,pe);var Be=class r extends ${constructor(e,t,n,i){super(e);this.nodeId=t;this.renderId=n;this.eventSource=i;y(this,"controls");this.engine.beginUndoGroup(),Lt().then(a=>{e.stores.toolStore.proseMirror??=a})}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}getVariableReference(){let e=this.getRichTextNode();if(!e)return;let t=e.htmlContent;if(V(t))return t}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let n=this.getVariableReference();if(n)return _(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,n,"richtext",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:n,variableDefinition:i,controlProp:a}=t;a.value!==e&&(n.setControlProp(i.id,{...a,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();if(!t||!r.supportsNode(e,t,this.renderId))e.exitTool();else{let n=this.getVariableInfo();this.engine.stores.toolStore.validateCollectionControl(n)}}stop(){this.engine.endUndoGroup(),this.engine.stores.toolStore.nodeInTextEditorId=null}static supportsNode(e,t,n){if(!A(t)||!V(t.htmlContent))return!1;let i=t.cache.getRenderInstance(n);return i?!!_(e.tree,e.stores.treeStore.sandboxCollectionData,t.htmlContent,"richtext",i.collectionItemId):!1}};var De=class r extends ${constructor(e,t,n,i){super(e);this.nodeId=t;this.renderId=n;this.eventSource=i;this.engine.beginUndoGroup();let a=this.getRichTextNode();p(a,"Missing rich text node");let l=Ho(this.engine.tree,a);at.loadFonts(l).catch(ae)}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}getVariableReference(){let e=this.getRichTextNode();if(!e)return;let t=e.textContent;if(V(t))return t}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let n=this.getVariableReference();if(n)return _(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,n,"string",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:n,variableDefinition:i,controlProp:a}=t;a.value!==e&&(n.setControlProp(i.id,{...a,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();if(!t||!r.supportsNode(e,t,this.renderId))e.exitTool();else{let n=this.getVariableInfo();this.engine.stores.toolStore.validateCollectionControl(n)}}stop(){this.engine.endUndoGroup(),this.engine.stores.toolStore.nodeInTextEditorId=null}static supportsNode(e,t,n){if(!A(t)||!V(t.textContent))return!1;let i=t.cache.getRenderInstance(n);return i?!!_(e.tree,e.stores.treeStore.sandboxCollectionData,t.textContent,"string",i.collectionItemId):!1}};var Re=class r extends ${update(){let o=this.engine,{routeStore:e,canvasStore:t,treeStore:n,mouseStore:i,toolStore:a}=o.stores,l=me({screenWidth:t.screenWidth,tree:n.tree,webPageNodeId:e.webPageNodeId});if(!l||i.isHoveringFloatingCanvasChrome)return;if(i.isHoveringChrome){a.highlightedRenderId=void 0;return}let s=n.tree,f=i.canvasMousePosition,m=s.getNodeRendersAtPoint(l,f,!0),c=ea(m,s),d=c.filter(U=>r.isLockedOrBlockedByAnOverlappedLockedLayer(o,U.node,U.renderId)||r.isInteractiveNodeOrTopLevelRepeaterNode(o,U.node,U.renderId)).at(-1);if(d){o.stores.toolStore.highlightedRenderId=d.renderId;return}let I=c.filter(U=>r.isUnexpectedlyNonInteractiveNode(o,U.node,U.renderId)).at(-1);if(I){a.highlightedRenderId=I.renderId;return}a.highlightedRenderId=void 0}static isInteractiveNodeOrTopLevelRepeaterNode(o,e,t){return r.isInteractiveNode(o,e,t)||lr(o,e)}static isHighlightableNode(o,e,t){return r.isLockedOrBlockedByAnOverlappedLockedLayer(o,e,t)?!1:Le.supportsNode(o,e,t)||_e.supportsNode(o,e,t)||He.supportsNode(o,e,t)||ye.supportsNode(e)||Be.supportsNode(o,e,t)||De.supportsNode(o,e,t)||Ve.supportsNode(o,e,t)||We.supportsNode(o,e,t)}static isNodeSupported(o,e,t){return Le.supportsNode(o,e,t)||_e.supportsNode(o,e,t)||He.supportsNode(o,e,t)||ye.supportsNode(e)||Be.supportsNode(o,e,t)||De.supportsNode(o,e,t)||Ve.supportsNode(o,e,t)||We.supportsNode(o,e,t)||pe.supportsNode(o,e)}static isInteractiveNode(o,e,t){return r.isNodeSupported(o,e,t)&&!r.isLockedOrBlockedByAnOverlappedLockedLayer(o,e,t)}static isUnexpectedlyNonInteractiveNode(o,e,t){return r.isNodeSupported(o,e,t)?r.isLockedOrBlockedByAnOverlappedLockedLayer(o,e,t):_i(e)||Oe(e)}static isLockedOrBlockedByAnOverlappedLockedLayer(o,e,t){if(ue.isOff("onPageLockedLayers"))return!1;if(jr(e)&&r.isNodeSupported(o,e,t))return!0;let n=me({screenWidth:o.stores.canvasStore.screenWidth,tree:o.stores.treeStore.tree,webPageNodeId:o.stores.routeStore.webPageNodeId});if(!n)return!1;let i=o.tree.getCornerPointsOnCanvasWithZoom(e,1),a=ie.centroid(i);return[...i,a].every(f=>{let m=o.tree.getNodesAtPoint(n,f),c=ko(m,o.tree).reverse();for(let u of c){if(jr(u)&&r.isNodeSupported(o,u,t))return!0;if(u.id===t)return!1}})}};function lr(r,o){return!(!Fi(o)||Us(r.tree,o)||xo(r.tree.getWebPageNodeFor(o)))}var Rd=g(te());var Ad="container_ci35ri5",Bd="shockwaveMask_suurpvn",Dd="shockwaveNodeHighlight_s1xlu29h";var dr=g(h()),kd=(0,Rd.memo)(function(){let o=x(),e=v(()=>o.stores.editableNodeHighlightStore.editableNodesHighlight,[]);return e?(0,dr.jsx)(qe.div,{className:Y(Ad,Bd),initial:{"--radius":`${e.minRadius}px`},animate:{"--radius":`${e.maxRadius}px`},transition:{duration:e.animationDuration/1e3,ease:"easeOut"},style:{top:e.minY,height:e.maxY-e.minY,"--x":`${e.originX}px`,"--y":`${e.originY}px`,"--gradient-size":`${e.gradientSize}px`},children:(0,dr.jsx)("div",{style:{position:"absolute",top:-e.minY},children:e.highlights.map(t=>(0,dr.jsx)("div",{className:Dd,style:{width:t.width,height:t.height,transform:t.transform,transformOrigin:"top left"}},t.renderId))})},e.animationId):null});var Md="hudContainer_h1czcor4";var Ld=g(te());var Od=g(te()),Vd=g(h()),J=(0,Od.forwardRef)(function({tree:o,node:e,renderId:t,style:n,overrideRect:i,...a},l){let s=x(),f=v(()=>{if(i)return i;let c=s.stores.treeStore.domLayoutUpdate,u=o.getRect(e,void 0,void 0,void 0,t);return{width:u.width,height:u.height,x:0,y:0}},[o,e,t,i],Te.equals),m=o.transformMatrixToNode(e,void 0,void 0,t);return(0,Vd.jsx)("div",{...a,ref:l,style:{position:"absolute",width:f.width,height:f.height,top:f.y,left:f.x,transformOrigin:"top left",transform:m.toString(),...n}})});var wn=g(h());function _d({tool:r}){let{renderId:o}=r,e=he(),t=x(),n=t.tree,i=(0,Ld.useRef)(null),a=r.getNode();if(Wt(i,()=>{t.exitTool()}),!!a&&e)return(0,wn.jsx)(J,{ref:i,tree:n,node:a,renderId:o,children:(0,wn.jsx)(Gs,{tool:r,node:a,renderId:o,scopeNode:e})})}var Wd="validationBadge_v1r7rm12";var fr=g(h());function Zf(r){return r.message}function cr({validationWarning:r}){if(!r)return null;let o=Zf(r);return(0,fr.jsxs)("div",{className:Wd,children:[(0,fr.jsx)(ga,{width:10,height:10}),o]})}var mo=g(h());function Hd({tool:r}){let{nodeId:o,renderId:e}=r,t=x(),n=v(()=>t.stores.toolStore.validationWarning,[]),i=v(()=>t.stores.treeStore.tree,[]),a=v(()=>t.stores.toolStore.editorOverlayClipPath,[]),l=he(),s=v(()=>t.stores.toolStore.proseMirror,[]),f=i.getNodeWithTrait(o,A);if(!f||!l||!s)return;function m(c){c.target===c.currentTarget&&t.exitTool()}return(0,mo.jsxs)(J,{tree:i,node:f,renderId:e,children:[(0,mo.jsx)(cr,{validationWarning:n}),(0,mo.jsx)(Zs,{tool:r,scopeNode:l,node:f,renderId:e,proseMirror:s,zoom:1,onClickOutside:m,hasValidationWarning:!!n,style:{clipPath:a}})]})}var qt=g(te());var zd="popover_p6dts5z",jd="popoverWithModalInFront_pcmqzkm";var mr="nodeHighlight_nbqylm8",qd="visuallyHidden_v1pcr3uc",In="pointerCursor_p1mivvux",Kd="textCursor_t42x8tu",Gd="grabCursor_g1atul0u",Yd="notAllowedCursor_n1i0g06w",$d="background_b1t4nog5",Xd="repeaterActionButtonLine_r1wgs7ug",Zd="repeaterActionButtonTop_rsrrcv7",Jd="repeaterActionButtonBottom_rckttk2",Qd="repeaterActionButtonLeft_r12nxotj",ec="repeaterActionButtonRight_r460cpk",tc="repeaterActionButton_rrb252f",oc="repeaterActionIcon_rxpkzma",rc="clickThrough_c1ct4jl9";var X=g(h()),Qf=["bottom","top","right","left"],em={x:ge.inputSpacing,y:ge.inputSpacing};function ic({tool:r}){let[o,e]=(0,qt.useState)(null),t=x(),n=t.stores.modalStore.useState(d=>d.active.type!=="None"),[i,a]=(0,qt.useState)(!1);!i&&n&&a(!0);let l=v(()=>t.stores.treeStore.tree,[]),s=l.getNodeWithTrait(r.nodeId,vi),f=(0,qt.useMemo)(()=>{let d=l;return r.getEditableControls()},[r,l]);function m(){t.exitTool()}let c=s?.id,u=(0,qt.useMemo)(()=>c?[c]:[],[c]);if(!(!s||!f||f.length===0))return(0,X.jsx)(J,{tree:l,node:s,ref:e,renderId:r.renderId,className:mr,children:(0,X.jsx)(Mo,{anchor:o,alignSelf:"center",attachTo:Qf,offset:em,onClose:m,showArrow:!0,arrow:{anchor:o,alignSelf:"center"},fallbackToModalAppearance:!0,backdropTintEnabled:!1,className:Y(zd,n&&jd),focusTrapEnabled:!n,animateAppear:!i,zIndex:21,children:(0,X.jsx)(Ys,{displayDivider:!0,title:tm(s),onClose:m,children:(0,X.jsx)(Pe,{gap:0,paddingTop:ge.inputSpacing,paddingBottom:ge.inputSpacing,paddingLeft:ge.panelPadding,paddingRight:ge.panelPadding,children:f.map(d=>{if(d.type==="vectorSetItem")return(0,X.jsx)(al,{nodeIds:u,supportsVariables:!1,dynamicVectorSetIdentifier:void 0,codeComponentIdentifier:d.codeComponentIdentifier},"vectorSet");if(d.type==="component")switch(d.controlDescription.type){case"string":return p(d.reducedControlProp.type==="string"),(0,X.jsx)(co,{nodeIds:u,controlKey:d.controlKey,control:d.controlDescription,controlProp:d.reducedControlProp,onChange:(F,b)=>{p(d.controlProp.type==="string");let N=b(d.controlProp);fe(N,d.controlProp)||(s.setControlProp(F,N),t.stores.projectStore.commitTreeAndSend())}},d.controlKey);case"enum":return p(d.reducedControlProp.type==="enum"),(0,X.jsx)(lo,{controlKey:d.controlKey,control:d.controlDescription,controlProp:d.reducedControlProp,onChange:(F,b)=>{p(d.controlProp.type==="enum"),!fe(F,d.controlProp)&&(s.setControlProp(b,F),t.stores.projectStore.commitTreeAndSend())}},d.controlKey);case"richtext":return p(d.reducedControlProp.type==="richtext"),(0,X.jsx)(Yr,{title:d.controlDescription.title??"Unknown",children:(0,X.jsx)(K,{title:"Edit Content",className:Gr,onClick:()=>{t.stores.modalStore.set({type:"OnPageRichTextEditor",controlKey:d.controlKey,nodeId:r.nodeId,source:"on_page_hud"})}})},d.controlKey);case"image":case"responsiveimage":return p(d.reducedControlProp.type==="image"||d.reducedControlProp.type==="responsiveimage"),(0,X.jsx)(Zr,{nodeIds:u,controlKey:d.controlKey,control:d.controlDescription,controlProp:d.reducedControlProp,onChange:(F,b)=>{p(I.type==="image");let N=b(I);fe(N,I)||(s.setControlProp(F,N),t.stores.projectStore.commitTreeAndSend())},onUpload:async(F,b)=>{let N=await F;if(!N)return;p(d.controlProp.type==="image");let Ee=nl(d.controlProp,N);s.setControlProp(b,Ee),t.stores.projectStore.commitTreeAndSend()}},d.controlKey);case"date":return p(d.reducedControlProp.type==="date"),(0,X.jsx)($r,{controlKey:d.controlKey,control:d.controlDescription,controlProp:d.reducedControlProp,onChange:(F,b)=>{p(F.type==="date"),!fe(F,I)&&(s.setControlProp(b,F),t.stores.projectStore.commitTreeAndSend())}},d.controlKey);case"vectorsetitem":return p(d.reducedControlProp.type==="vectorsetitem"),(0,X.jsx)(Jr,{controlKey:d.controlKey,control:d.controlDescription,controlProp:d.reducedControlProp,onChange:(F,b)=>{p(F.type==="vectorsetitem"),!fe(F,d.controlProp)&&(s.setControlProp(b,F),t.stores.projectStore.commitTreeAndSend())}},d.controlKey);default:oo(d.controlDescription)}let{variableInfo:w}=d,{controlProp:I,controlDescription:U,collectionItemNode:T,variableDefinition:S,reducedControlProp:P}=w;switch(I.type){case"string":return p(U.type==="string"),p(P.type==="string"),(0,X.jsx)(co,{nodeIds:u,controlKey:S.id,control:U,controlProp:P,onChange:(F,b)=>{p(I.type==="string");let N=b(I);fe(N,I)||(T.setControlProp(F,N),t.stores.projectStore.commitTreeAndSend())}},d.controlKey);case"enum":return p(U.type==="enum"),p(P.type==="enum"),(0,X.jsx)(lo,{controlKey:S.id,control:U,controlProp:P,onChange:(F,b)=>{p(F.type==="enum"),!fe(F,I)&&(T.setControlProp(b,F),t.stores.projectStore.commitTreeAndSend())}},d.controlKey);case"richtext":return p(U.type==="richtext"),p(P.type==="richtext"),(0,X.jsx)(Yr,{title:U.title||wi(S.id),children:(0,X.jsx)(K,{title:"Edit Content",className:Gr,onClick:()=>{t.stores.modalStore.set({type:"OnPageRichTextEditor",controlKey:S.id,nodeId:T.id,source:"on_page_hud"})}})},d.controlKey);case"image":return p(U.type==="responsiveimage"),p(P.type==="responsiveimage"),(0,X.jsx)(Zr,{nodeIds:u,controlKey:S.id,control:U,controlProp:P,onChange:(F,b)=>{p(I.type==="image");let N=b(I);fe(N,I)||(T.setControlProp(F,N),t.stores.projectStore.commitTreeAndSend())},onUpload:async(F,b)=>{let N=await F;N&&(T.setControlProp(b,{type:"image",value:N}),t.stores.projectStore.commitTreeAndSend())}},d.controlKey);case"date":return p(U.type==="date"),p(P.type==="date"),(0,X.jsx)($r,{controlKey:S.id,control:U,controlProp:P,onChange:(F,b)=>{p(F.type==="date"),p(I.type==="date"),!fe(F,I)&&(T.setControlProp(b,F),t.stores.projectStore.commitTreeAndSend())}},d.controlKey);case"link":return p(U.type==="link"),p(P.type==="link"),(0,X.jsx)(Pl,{controlKey:S.id,control:U,controlProp:P,onChange:(F,b)=>{p(I.type==="link");let N=b(I);fe(N,I)||(T.setControlProp(F,N),t.stores.projectStore.commitTreeAndSend())}},d.controlKey);case"boolean":return p(U.type==="boolean"),p(P.type==="boolean"),(0,X.jsx)(Jo,{nodeIds:u,controlKey:S.id,control:U,controlProp:P,onChange:(F,b)=>{p(F.type==="boolean"),p(I.type==="boolean"),!fe(F,I)&&(T.setControlProp(b,F),t.stores.projectStore.commitTreeAndSend())}},d.controlKey);case"vectorsetitem":return p(U.type==="vectorsetitem"),p(P.type==="vectorsetitem"),(0,X.jsx)(Jr,{controlKey:S.id,control:U,controlProp:P,onChange:(F,b)=>{p(F.type==="vectorsetitem"),p(I.type==="vectorsetitem"),!fe(F,I)&&(T.setControlProp(b,F),t.stores.projectStore.commitTreeAndSend())}},d.controlKey);default:oo(I)}})})})})})}function tm(r){let o=ne.reactComponentForIdentifier(r.codeComponentIdentifier);return o?o.name:"Component"}var pr=g(te());var Un=g(h());function ac({tool:r}){let{nodeId:o,renderId:e}=r,t=x(),n=t.tree,i=(0,pr.useRef)(null),a=he(),l=n.getNodeWithTrait(o,A);if(Wt(i,()=>{t.exitTool()}),(0,pr.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"})),!!l&&a)return(0,Un.jsx)(J,{ref:i,tree:n,node:l,renderId:e,children:(0,Un.jsx)($s,{tool:r,scopeNode:a,node:l,renderId:e,backdropEnabled:!0})})}var sc=g(te());var Cn=g(h());function lc({tool:r}){let{nodeId:o,renderId:e}=r,t=x(),n=t.tree,i=(0,sc.useRef)(null),a=he(),l=n.getNodeWithTrait(o,A);if(Wt(i,()=>{t.exitTool()}),!!l&&a)return(0,Cn.jsx)(J,{ref:i,tree:n,node:l,renderId:e,children:(0,Cn.jsx)(Xs,{tool:r,node:l,renderId:e,scopeNode:a})})}var xt=g(te());var de=g(h());function cc(){let r=x(),o=v(()=>r.stores.treeStore.tree,[]),e=v(()=>r.stores.toolStore.highlightedRenderId,[]),t=v(()=>r.stores.mouseStore.lastUpdateType==="scroll",[]),n=v(()=>r.stores.mouseStore.isHoveringFloatingCanvasChrome,[]),i=Rt("onPageQuickAddRepeaterItems"),a=ht(e),l=o.get(a),s=kr(l),f=!xe(e),m=(0,xt.useMemo)(()=>{if(!i||!l||!e)return null;if(lr(r,l))return l;let S=l.ancestors();for(let P of S)if(lr(r,P))return P;return null},[l,e,i]),c=s&&f,u=c&&!t&&Re.isHighlightableNode(r,l,e),d=c&&Re.isUnexpectedlyNonInteractiveNode(r,l,e),w=c&&!d&&!n&&Re.isInteractiveNode(r,l,e),I=!!m&&!t,U=rm({highlightedNode:l,highlightedRenderId:e,engine:r}),T=im(l,e);return(0,de.jsxs)(de.Fragment,{children:[(0,de.jsx)(om,{notAllowedCursor:d}),c&&(0,de.jsxs)(de.Fragment,{children:[w&&(0,de.jsx)(J,{tree:o,node:l,renderId:e,className:Y(mr,!u&&qd,U),onMouseDown:T}),I&&(0,de.jsx)(am,{tree:o,highlightedRenderId:e,repeaterNode:m})]})]})}function om(r){let o=x(),e=(0,xt.useCallback)(()=>{o.stores.editableNodeHighlightStore.highlight(o,{type:"clickOnVoid"})},[]);return(0,de.jsx)("div",{"aria-hidden":!0,className:Y($d,r.notAllowedCursor&&Yd),onClick:e})}function rm({highlightedNode:r,highlightedRenderId:o,engine:e}){let t=kr(r),n=!xe(o);return!t||!n?In:ye.supportsNode(r)||Be.supportsNode(e,r,o)||De.supportsNode(e,r,o)?Kd:pe.supportsNode(e,r)?Gd:In}var nm=r=>{switch(r){case"top":return Zd;case"bottom":return Jd;case"left":return Qd;case"right":return ec}};function im(r,o){let e=x();return(0,xt.useCallback)(()=>{!r||!o||(pe.supportsNode(e,r)?e.startMoveTool(r.id,o,()=>{dc(e,r,o)||e.startHighlightTool()}):dc(e,r,o))},[r,o])}function dc(r,o,e){return Le.supportsNode(r,o,e)?(r.startComponentInstanceEditTool(o.id,e),!0):_e.supportsNode(r,o,e)?(r.startDateVariableEditTool(o.id,e,"mouse"),!0):He.supportsNode(r,o,e)?(r.startImageEditTool(o.id,e),!0):ye.supportsNode(o)?(r.startRichTextEditTool(o.id,e,"mouse"),!0):Be.supportsNode(r,o,e)?(r.startRichTextVariableEditTool(o.id,e,"mouse"),!0):De.supportsNode(r,o,e)?(r.startStringVariableEditTool(o.id,e,"mouse"),!0):Ve.supportsNode(r,o,e)?(r.startCollectionReferenceVariableEditTool(o.id,e,"mouse"),!0):We.supportsNode(r,o,e)?(r.startEnumVariableEditTool(o.id,e,"mouse"),!0):(r.stores.editableNodeHighlightStore.highlight(r,{type:"clickOnVoid"}),!1)}function am(r){let o=x(),{mouseStore:e}=o.stores,{tree:t,highlightedRenderId:n,repeaterNode:i}=r,a=v(()=>e.canvasMousePosition,[],yi),l=(0,xt.useMemo)(()=>{if(!i)return;let f=Wi(t,i);if(!f)return;let m=f.cache.domRects,c=null;for(let[u,d]of m??[])c=c?Te.merge(c,d):d;if(c)return c},[t,i]),s=(0,xt.useMemo)(()=>{let f="bottom";if(!i)return f;let m=Ci(i)&&i.stackDirection==="horizontal"&&!i.stackWrapEnabled,c=t.convertFrameToCanvas(i,l,n);if(m){let S=c.x,P=S+c.width,F=window.scrollX,b=F+window.innerWidth,N=S>=F&&S<=b,Ee=P>=F&&P<=b;if(N&&!Ee)return"left";if(Ee&&!N)return"right";if(N&&Ee){let $e=a.x-S,ze=P-a.x;return $e<ze?"left":"right"}return"right"}let u=c.y,d=u+c.height,w=window.scrollY,I=w+window.innerHeight,U=u>=w&&u<=I,T=d>=w&&d<=I;if(U&&!T)return"top";if(T&&!U)return"bottom";if(U&&T){let S=a.y-u,P=d-a.y;return S<P?"top":"bottom"}return f},[i,n,l,a,t.convertFrameToCanvas]);return i?(0,de.jsx)(J,{tree:t,node:i,renderId:n,className:rc,overrideRect:l,children:(0,de.jsxs)("button",{type:"button",className:Y(tc,nm(s)),onMouseDown:()=>sm(o,i.id),[en]:"true",children:[(0,de.jsx)(ya,{className:oc,children:(0,de.jsx)(da,{})}),(0,de.jsx)("div",{className:Xd})]})}):null}function sm(r,o){let{treeStore:e,projectStore:t,modalStore:n,accessStore:i}=r.stores,a=e.tree.getNodeWithTrait(o,Or),l=Or(a)&&xo(a)?ki(e.tree,a.dataIdentifier):void 0,s=i.access?.userId;p(s,"User must be logged in"),p(l,"Collection node must exist");let f=Ro.create({isDraft:!0,privateToUserId:s});Yo(l,f),e.tree.insertNode(f,l.id,0),t.commitTreeAndSend(),n.set({type:"OnPageCMSFieldsModal",fieldIdsToShow:ir(l),requiredFieldsOnly:!1,source:"on_page_hud",collectionNodeId:l.id,collectionItemId:f.id})}var Ie=g(te());var fc="popout_pqnmppj";var ke=g(h()),dm=["right","left"],cm={x:15,y:0};function mc({tool:r}){let{nodeId:o,renderId:e}=r,[t,n]=(0,Ie.useState)(null),i=x(),a=v(()=>i.stores.treeStore.tree,[]),l=a.getNodeWithTrait(o,kt);function s(){i.exitTool()}if(l)return(0,ke.jsx)(J,{tree:a,node:l,renderId:e,ref:n,children:(0,ke.jsxs)(Mo,{anchor:t,alignSelf:"center",attachTo:dm,offset:cm,onClose:s,showArrow:!0,arrow:{anchor:t,alignSelf:"center"},fallbackToModalAppearance:!0,backdropTintEnabled:!1,children:[(0,ke.jsx)(va,{disableDivider:!0,onClose:s,children:(0,ke.jsx)(Sa,{title:"Image"})}),(0,ke.jsx)("div",{className:fc,children:Me(l.fillImage)?(0,ke.jsx)(fm,{node:l,dynamicValue:l.fillImage,renderId:e}):(0,ke.jsx)(pm,{node:l})})]})})}function fm({node:r,dynamicValue:o,renderId:e}){return p(V(o),"Expected variable reference"),(0,ke.jsx)(mm,{node:r,variableReference:o,renderId:e})}function mm({node:r,variableReference:o,renderId:e}){let t=x(),n=v(()=>{let m=t.stores.treeStore,c=r.cache.getRenderInstance(e);return _(m.tree,m.sandboxCollectionData,o,"image",c?.collectionItemId)},[r,e,o]);p(n,"Variable info must exist");let{collectionItemNode:i,reducedControlProp:a,controlProp:l}=n;p(a.type==="responsiveimage","Expected reduced responsive image");let s=(0,Ie.useCallback)(m=>{i.set(Vr({[o.id]:m(l)})),t.stores.projectStore.commitTreeAndSend()},[i,o,l]),f=(0,Ie.useCallback)(()=>{i.set(Vr({[o.id]:{type:"image",value:void 0}})),t.stores.projectStore.commitTreeAndSend()},[i,o]);return(0,ke.jsx)(Ms,{controlProp:a,onChange:s,onRemove:f,maxExtraImages:0})}function pm({node:r}){let o=x(),e=(0,Ie.useMemo)(()=>{let m={...ws(),...Cs()};return Is(r,m),Fs(r,m),m},[r]),t=(0,Ie.useCallback)(async m=>{let[c]=await m;c&&(ss(r,c),o.stores.projectStore.commitTreeAndSend())},[r]),n=(0,Ie.useCallback)(m=>{se(r.fillImage)&&(r.set({fillImage:fi(r.fillImage,m)}),o.stores.projectStore.commitTreeAndSend())},[r]),i=(0,Ie.useCallback)(m=>{Hi(r)&&(r.set({altAttribute:m}),o.stores.projectStore.commitTreeAndSend())},[r]),a=(0,Ie.useCallback)(m=>{r.set({fillImageResize:m}),o.stores.projectStore.commitTreeAndSend()},[r]),l=(0,Ie.useCallback)(m=>{r.set({fillImageTileSize:m}),o.stores.projectStore.commitTreeAndSend()},[r]),s=(0,Ie.useCallback)((m,c)=>{r.set({fillImagePositionX:m,fillImagePositionY:c}),o.stores.projectStore.commitTreeAndSend()},[r]),f=(0,Ie.useCallback)(()=>{r.set({fillImage:void 0}),o.stores.projectStore.commitTreeAndSend()},[r]);return(0,ke.jsx)(Ds,{...e,imageReferences:e.fillImages,altText:e.altAttribute,onChangeImages:t,onChangeAssetSize:n,onChangeAltText:i,onChangeImageResize:a,onChangeFillImageSize:l,onChangeImagePosition:s,onRemoveImage:f})}var pc="grabCursor_g189l9ii",uc="moveHighlightParent_m1va6tk8";var yc=g(h());function gc({tool:r}){let o=x(),e=v(()=>r.hasMoved,[r]),t=v(()=>o.stores.treeStore.tree,[]),n=t.get(r.nodeId);if(!n)return null;let i=t.get(n.parentid);if(!i)return null;let l=n.cache.getRenderInstance(r.renderId)?.parentRenderId??i.id;return(0,yc.jsx)(J,{tree:t,node:i,renderId:l,className:Y(e&&uc,pc)})}var Ic=g(te());var hc="warningButton_w1uyyr5z",wc="warningButtonIcon_w1z0oe1i";var po=g(h());function Uc({richTextNode:r,webPageNode:o}){let e=x(),t=v(()=>e.stores.treeStore.tree,[]);return(0,Ic.useMemo)(()=>{let i=t.getNodeWithTrait(r.getPrimaryId(),A);return p(i,"originalNode must exist"),o.getTopLevelReplicaVariants().some(a=>{let l=so(a.id,i.id),s=t.get(l);return A(s)&&Do(t,s,"html")&&s.getTextContent()!==i.getTextContent()})},[t,r,o])?(0,po.jsxs)(la,{className:hc,onClick:()=>{e.exitTool(),e.stores.modalStore.set({richTextNodeId:r.id,source:"on_page_hud",type:"OnPageRichTextVariantOverride"})},children:[(0,po.jsx)(pa,{viewBox:"0 0 12 12",className:wc}),(0,po.jsx)(Qe,{children:"Responsive Text"})]}):null}var Cc="warningContainer_w1v62ead";var Kt=g(h());function Fc({tool:r}){let{nodeId:o,renderId:e}=r,t=x(),n=v(()=>t.stores.treeStore.tree,[]),i=v(()=>t.stores.toolStore.editorOverlayClipPath,[]),a=v(()=>t.stores.toolStore.proseMirrorView,[]),l=n.getNodeWithTrait(o,A),s=he();return!l||!s||!a?null:(0,Kt.jsxs)(J,{tree:n,node:l,renderId:e,children:[(0,Kt.jsx)("div",{className:Cc,children:(0,Kt.jsx)(Uc,{richTextNode:l,webPageNode:s})}),(0,Kt.jsx)(Js,{tool:r,scopeNode:s,node:l,renderId:e,editorView:a,zoom:1,handleOutsideClick:f=>{f.target===f.currentTarget&&t.exitTool()},style:{clipPath:i}})]})}var uo=g(h());function xc({tool:r}){let{nodeId:o,renderId:e}=r,t=x(),n=v(()=>t.stores.treeStore.tree,[]),i=v(()=>t.stores.toolStore.validationWarning,[]),a=v(()=>t.stores.toolStore.editorOverlayClipPath,[]),l=n.getNodeWithTrait(o,A),s=he();return!s||!l?null:(0,uo.jsxs)(J,{tree:n,node:l,renderId:e,children:[(0,uo.jsx)(cr,{validationWarning:i}),(0,uo.jsx)(Qs,{tool:r,scopeNode:s,node:l,renderId:e,zoom:1,onClickOutside:f=>{f.target===f.currentTarget&&t.exitTool()},hasValidationWarning:!!i,style:{clipPath:a}})]})}var ce=g(h());function Pc(){let r=x(),{sandboxStore:o}=r.stores,{canvasHeight:e}=o.useState(),t=v(()=>r.stores.treeStore.tree.getPresetsListNode(),[]);return(0,ce.jsxs)("div",{className:Md,style:{height:e??"initial"},children:[(0,ce.jsx)(kd,{}),(0,ce.jsx)(hm,{}),(0,ce.jsx)(gs,{presetsListNode:t})]})}function hm(){let r=x(),{projectStore:o,modalStore:e}=r.stores,t=v(()=>r.stores.toolStore.tool,[]),n=v(()=>r.stores.canvasStore.finishedEditing,[]),{hasPermanentlyFailed:i}=o.useState(),a=e.useState(l=>l.active.type!=="None");if(!i&&!n&&!a){if(t instanceof pe)return(0,ce.jsx)(gc,{tool:t});if(t instanceof Re)return(0,ce.jsx)(cc,{});if(t instanceof He)return(0,ce.jsx)(mc,{tool:t});if(t instanceof ye)return(0,ce.jsx)(Fc,{tool:t});if(t instanceof Be)return(0,ce.jsx)(Hd,{tool:t});if(t instanceof De)return(0,ce.jsx)(xc,{tool:t});if(t instanceof _e)return(0,ce.jsx)(ac,{tool:t});if(t instanceof Ve)return(0,ce.jsx)(_d,{tool:t});if(t instanceof We)return(0,ce.jsx)(lc,{tool:t});if(t instanceof Le)return(0,ce.jsx)(ic,{tool:t})}}var Ge=g(h());function bc(){Ht();let r=x(),o=v(()=>r.stores.canvasStore.isHidden,[]);return(0,ur.useEffect)(()=>{let e=({data:t})=>{if(st(t)&&t.apiVersion===1){let{type:n,position:i}=t;n==="showCanvas"&&st(i)&&no(i.top)&&(window.scrollTo({behavior:"instant",top:i.top}),setTimeout(()=>{r.stores.canvasStore.isHidden=!1,r.startHighlightTool(),r.stores.editableNodeHighlightStore.highlight(r,{type:"start"})},0))}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),(0,ur.useEffect)(()=>{let{sandboxStore:e}=r.stores;o?e.hide():e.show()},[o]),wm(o),xl({channel:ai,toast:dt}),(0,Ge.jsx)(Ia,{children:(0,Ge.jsxs)("div",{className:Y(o&&Al),children:[(0,Ge.jsx)(Pc,{}),(0,Ge.jsxs)("div",{className:Bl,[Qr]:"true",children:[(0,Ge.jsx)(Ed,{}),(0,Ge.jsx)(Id,{}),(0,Ge.jsx)(Aa,{padding:80}),(0,Ge.jsx)(Cl,{ref:r.stores.projectStore.filePickerRef})]})]})})}function wm(r){let o=x();(0,ur.useEffect)(()=>{if(r)return;let e=new Bs;e.set("CommandOrControl+Z",o.undo.bind(o),"undo"),e.set("CommandOrControl+Shift+Z",o.redo.bind(o),"redo");function t(n){if(zo())return;let i=e.get(n);i&&(Ae("keyboard_shortcut",{shortcut:As(n)}),i.action(n),n.preventDefault(),n.stopPropagation())}return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[r])}var vc=g(te());function Sc(){(0,vc.useEffect)(()=>{let r=o=>{if(!st(o.data))return;let{apiVersion:e,type:t}=o.data;e===1&&t==="enterOnPageEditing"&&Ae("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-enter-on-page-editing"})};return window.addEventListener("message",r),()=>window.removeEventListener("message",r)},[])}var Sn=g(te());var Gt="https://app.framerstatic.com/framer-logo-blue-UQOIW3P5.png";var yr="button_b9jl8lf",hr="editorBarButtonPrimary_eptse9g";var Ec="backdrop_bzafg2a",Tc="container_cnhgigm",Nc="textContainer_t1ookr3o",Ac="title_tyol4w7",Bc="subtitle_s7fryoi",Dc="button_by9jupw",Rc="buttonsContainer_b18g1n4a",kc="closeModal_c1gc3a0q";var Yt=g(h());function Mc({width:r=10,height:o=10,className:e}){return(0,Yt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,height:o,fill:"none",className:e,"aria-hidden":"true",children:(0,Yt.jsxs)("g",{transform:"translate(2 2)",children:[(0,Yt.jsx)("path",{d:"M 0 0 L 6 6",fill:"transparent",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),(0,Yt.jsx)("path",{d:"M 0 6 L 6 0",fill:"transparent",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})})}var Ue=g(h());function Cm({children:r,onClick:o,disabled:e,layoutId:t,duration:n}){return(0,Ue.jsx)(qe.div,{layout:"position",layoutId:t,style:{width:"100%"},transition:{duration:n,type:"spring",bounce:.2,delay:0},children:(0,Ue.jsx)(K,{type:"button",className:Dc,onClick:o,enabled:!e,children:r})})}function $t({logo:r,title:o,subtitle:e,buttons:t,showLearnMoreButton:n}){let i=()=>{window.open("https://www.framer.com/help/articles/on-page-editing","_blank")},a=()=>{window.parent.postMessage({apiVersion:1,type:"sandboxReadyState",data:{status:"ready"}},"*"),window.parent.postMessage({apiVersion:1,type:"exitFullscreen",position:{top:window.scrollY}},"*")};return(0,Ue.jsx)(Pe,{className:Ec,onClick:a,children:(0,Ue.jsxs)(Pe,{className:Tc,justifyContent:"center",alignItems:"center",onClick:l=>l.stopPropagation(),children:[(0,Ue.jsx)(Pe,{onClick:a,className:kc,children:(0,Ue.jsx)(Mc,{})}),(0,Ue.jsxs)(Pe,{className:Nc,gap:15,alignItems:"center",justifyContent:"center",children:[r,(0,Ue.jsxs)(Pe,{gap:5,alignItems:"center",justifyContent:"center",children:[(0,Ue.jsx)(qe.span,{layout:!0,className:Ac,children:o}),(0,Ue.jsx)(qe.p,{layout:!0,className:Bc,children:e})]})]}),t||n?(0,Ue.jsxs)(Pe,{className:Rc,gap:10,children:[n?(0,Ue.jsx)(Cm,{onClick:i,children:"Learn More"}):null,t||null]}):null]})})}var wr=g(h());function Oc(){let r=x();_t("editor_bar_impression",{page:"editor-bar-cookie-prompt"});async function o(){Ae("editor_bar_interaction",{page:"editor-bar-cookie-prompt",id:"editor-bar-allow-cookies"});try{await document.requestStorageAccess()}finally{await r.stores.accessStore.refresh()}}return(0,wr.jsx)($t,{logo:(0,wr.jsx)("img",{decoding:"async",width:36,src:Gt,alt:"Framer Logo"}),title:"Edit Page",subtitle:"Continuing may require granting permissions in a browser dialog.",buttons:(0,wr.jsx)(K,{className:Y(yr,hr),onClick:o,variant:"primary",children:"Continue"}),showLearnMoreButton:!0})}var Pn=g(h());function Vc({children:r,onClick:o,disabled:e,layoutId:t,duration:n,className:i}){return(0,Pn.jsx)(qe.div,{layout:"position",layoutId:t,style:{width:"100%"},transition:{duration:n,type:"spring",bounce:.2,delay:0},children:(0,Pn.jsx)(K,{type:"button",className:Y(yr,i),onClick:o,enabled:!e,children:r})})}var Lc="loginButtonLoading_l4nhz4u";var Xt=g(h());function _c(){let r=x(),{isLoginInProgress:o}=r.stores.loginStore.useState();_t("editor_bar_impression",{page:"editor-bar-guest-page"});async function e(){Ae("editor_bar_interaction",{page:"editor-bar-guest-page",id:"editor-bar-login"}),await r.stores.loginStore.login()}return(0,Xt.jsx)($t,{logo:(0,Xt.jsx)("img",{decoding:"async",width:36,height:36,src:Gt,alt:"Framer Logo"}),title:"Edit Page",subtitle:"Edit the page directly in the browser, without opening the app.",buttons:(0,Xt.jsx)(Vc,{onClick:e,disabled:o,className:hr,children:o?(0,Xt.jsx)("div",{className:Lc,children:(0,Xt.jsx)(Ul,{})}):"Continue"}),showLearnMoreButton:!0})}var bn=g(h()),xm="Page Edit",Pm="To edit, ask the site owner for access to the project",bm="To edit, ask the site owner for content editing permissions";function vn({reason:r}){return _t("editor_bar_impression",{page:"editor-bar-no-access-page"}),(0,bn.jsx)($t,{logo:(0,bn.jsx)("img",{decoding:"async",width:36,src:Gt,alt:"Framer Logo"}),title:xm,subtitle:r==="no-permission"?bm:Pm,showLearnMoreButton:!0})}var go=g(h());function Wc(){let r=x(),{access:o}=r.stores.accessStore.useState();switch(o.status){case"no-auth":return(0,go.jsx)(_c,{});case"unknown":return(0,go.jsx)(Oc,{});case"no-access":return(0,go.jsx)(vn,{reason:"no-access"});case"no-permission":return(0,go.jsx)(vn,{reason:"no-permission"});case"success":case"error":return null;default:oo(o)}}var Pt=g(h());function Hc(){let r=x(),{shouldRenderOnPageCanvas:o}=r.stores.accessStore.useState(),e=et(()=>r.stores.routeStore.webPageNodeId,[],[r.stores.routeStore]);return(0,Sn.useEffect)(()=>{e&&r.stores.sandboxStore.waitForInitialLoad(e).then(()=>{window.parent.postMessage({apiVersion:1,type:"sandboxReadyState",data:{status:"ready"}},"*")}).catch(ae)},[e]),(0,Sn.useEffect)(()=>{r.performanceTracker.reportEditorBarReady()}),Sc(),(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Wc,{}),o&&(0,Pt.jsx)(bc,{})]})}var zc=g(te());var qc=g(h());function jc(){let r=x(),o=(0,zc.useCallback)(()=>{r.stores.contextMenuStore.close()},[]);return(0,qc.jsx)(el,{environment:"onPage",menu:r.stores.contextMenuStore.menu,onClose:o})}var Ir=class{constructor(o){this.engine=o;y(this,"state",0);y(this,"changes",new ra)}get inRendering(){return this.state===3}render(){if(this.state!==1)return;let o=this.changes,e=this.engine.stores;try{this.state=2,o.has(e.treeStore,e.routeStore)&&Vo(e.treeStore.tree,e.treeStore.layoutCache,e.treeStore.sandboxCollectionData,e.treeStore.sandboxVisibility,ne.activeBundleHash,e.routeStore.localeId,void 0,e.routeStore.webPageNodeId),e.toolStore.tool?.update?.(),e.undoRedoManager.processScheduledEndUndoGroup({}),this.state=3,e.sandboxStore.update(),o.signalAllObservers(),Vs()}finally{this.state=0}}signalChanges(o){if(this.changes.addChanges(o),this.state!==0)return;this.state=1;let e=this.render.bind(this);setTimeout(e,0),Os()}wrapHandler(o,e){let{projectStore:t}=this.engine.stores;return function(...n){let i=o.apply(this,n);return t.commitTreeAndSend(e!=="nonUserEvent"),i}}process(o,e){this.wrapHandler(o,e)()}processWhenReady(o,e){this.wrapHandler(o,e)()}async processWhenReadyAsync(o,e){return this.wrapHandler(o,e)()}runWhenIdle(o){requestIdleCallback(o)}runWithFullyLoadedTree(o,e){p(e.runInBackground,"Only background tasks are supported in the OnPageEngine for now.");let t=this.engine.tree.getService("loader"),n=()=>{o(),this.engine.stores.projectStore.commitTreeAndSend()};if(!t)return n(),ct;let i=t.prioritizeLoadingAllData({operationName:e.name,operationInBackground:!0,doNotTrack:e.doNotTrack}),a=t.afterAllDataLoaded(n);return()=>{i(),a()}}runBeforeNextFrame(o){requestAnimationFrame(o)}scheduleDocumentUpdateIgnoringUndo(o){throw new Error("Not implemented")}};var Ur=class extends Ne{constructor(e,t,n){super();this.projectStore=e;this.hostnameStore=t;this.siteId=n;y(this,"_access")}get access(){return p(this._access,"Access not initialized"),this._access}get projectId(){return Kc(this.access)}get canEditContent(){let e=this.access;return e.status!=="success"?!1:e.data.permissions?.canEditContent==="on"}get shouldRenderOnPageCanvas(){return tn()&&this.canEditContent}async set(e){if(this._access=e,this.shouldRenderOnPageCanvas){let t=Kc(e);e.userId&&t&&(this.projectStore.loadProject(e.userId,t),this.hostnameStore.loadHostnames(t).catch(ae))}Gi.setUserId(e.userId??"null")}async refresh(){let e=await Fl(this.siteId);await this.set(e)}},vm=/^(?<name>.+--)?(?<id>[a-z0-9]{20})(?<hash>-[a-z0-9]+)?$/iu;function Kc(r){if(r.status==="success")return vm.exec(r.data.projectSlug)?.groups?.id}var Gc,Yc,bt,En,Tn;Yc=[R()],Gc=[R()];var vt=class{constructor(o){this.scheduler=o;D(this,En,C(bt,8,this,[])),C(bt,11,this);D(this,Tn,C(bt,12,this)),C(bt,15,this);y(this,"assetMap",new di)}get assets(){return this._assets}get assetService(){return this._assetService}setAssetService(o){this._assetService=o,ci(o,e=>{e.assets&&(this._assets=e.assets,this.assetMap.set(e.assets),at.importCustomFonts(e.assets,ue.isOn("customFontGrouping")))})}};bt=oe(null),En=new WeakMap,Tn=new WeakMap,E(bt,4,"_assets",Yc,vt,En),E(bt,4,"_assetService",Gc,vt,Tn),re(bt,vt);async function $c(r){return Ba.post("/edit/notifications/page-edited",r)}var Xc,Zc,Jc,Qc,ve,Nn,An,Bn,Dn;Qc=[R()],Jc=[R()],Zc=[R()],Xc=[R()];var rt=class{constructor(o,e,t,n,i,a,l,s,f){this.scheduler=o;this.accessStore=e;this.routeStore=t;this.treeStore=n;this.projectStore=i;this.modalStore=a;this.undoRedoManager=l;this.exitTool=s;this.onChangeRoute=f;D(this,Nn,C(ve,8,this,!0)),C(ve,11,this);D(this,An,C(ve,12,this,null)),C(ve,15,this);D(this,Bn,C(ve,16,this,window.innerWidth)),C(ve,19,this);D(this,Dn,C(ve,20,this)),C(ve,23,this);window.addEventListener("resize",()=>{this._screenWidth=window.innerWidth})}get screenWidth(){return this._screenWidth}get temporaryCollectionItemNodeId(){return this._temporaryCollectionItemNodeId}set temporaryCollectionItemNodeId(o){this._temporaryCollectionItemNodeId=o,this.onChangeRoute()}async sendNotification(o){let e=this.accessStore.projectId;p(e,"Project ID must exist");let t=ot({tree:this.treeStore.tree,webPageNodeId:this.routeStore.webPageNodeId});p(t,"Web page node must exist");let n=Ke(this.routeStore,this.treeStore,this),i;if(n){let a=zt(this.routeStore,this.treeStore,this);p(a,"Collection item exists, so its parent collection must exist");let l=a.resolveValue("name");p(l,"Collection node must have a name"),i={notificationType:o,projectId:e,webPageNodeId:t.id,collectionItemNodeId:n.id,collectionItemTitle:Sm(a,n),collectionTitle:l,pageType:"cms-detail"}}else i={notificationType:o,projectId:e,webPageNodeId:t.id,pageTitle:t.webMetadata?.title||Va(this.treeStore.tree,t),pageType:"static"};await $c(i)}createTemporaryCollectionItem(){let o=zt(this.routeStore,this.treeStore,this);if(!o)return;let e=this.accessStore.access?.userId;p(e,"User must be logged in");let t=o.getPrivateItemForUser(e);if(t)this.temporaryCollectionItemNodeId=t.id;else{let n=Ro.create({isDraft:!0,privateToUserId:e});this.treeStore.tree.insertNode(n,o.id,0),this.temporaryCollectionItemNodeId=n.id,Yo(o,n),this.projectStore.commitTreeAndSend()}}discardTemporaryCollectionItem(){let o=Ke(this.routeStore,this.treeStore,this);p(o,"Collection item node must exist"),p(o.id===this.temporaryCollectionItemNodeId,"Collection item must be temporary"),this.treeStore.tree.remove(o.id),this.projectStore.commitTreeAndSend(),this.clearTemporaryItem(),this.exitFullscreen()}saveTemporaryCollectionItem(){let o=Ke(this.routeStore,this.treeStore,this);p(o,"Collection item node must exist"),p(o.id===this.temporaryCollectionItemNodeId,"Collection item must be temporary"),o?.set({privateToUserId:void 0}),this.projectStore.commitTreeAndSend(),this.finishEditingWithChanges(o.id,!0)}handleFinishEditing(){this.exitTool();let o=Ke(this.routeStore,this.treeStore,this);if(!!!o?.privateToUserId){if(!this.treeStore.hasChanged()){this.handleDismissFinishEditing();return}let s=this.routeStore.projectLinkNodeId;if(!s)return;this.finishEditingWithChanges(s,!1);return}let t=zt(this.routeStore,this.treeStore,this);if(p(t&&o,"Collection node and collection item node must exist"),!o.hasData()){this.discardTemporaryCollectionItem();return}let n=jo(t,o);Es(t,o,n)&&this.projectStore.commitTreeAndSend();let l=Ss(this.treeStore.tree,t,o,n).flatMap(s=>{let f=s.type;return yn[f]!==void 0?s.id:[]});l.length>0?this.modalStore.set({type:"OnPageCMSFieldsModal",fieldIdsToShow:l,requiredFieldsOnly:!0,source:"on_page_hud",collectionItemId:o.id,collectionNodeId:t.id}):this.saveTemporaryCollectionItem()}finishEditingWithChanges(o,e){this.finishedEditing={isNewItem:e,nodeId:o},Ae("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-finish-editing-with-changes"});let t=e?"page-created":"page-edited";this.sendNotification(t).catch(ae)}handleDismissFinishEditing(){this.clearTemporaryItem(),this.undoRedoManager.clearUndoStack(),this.exitFullscreen()}exitFullscreen(){window.parent.postMessage({apiVersion:1,type:"exitFullscreen",position:{top:window.scrollY}},"*"),this.isHidden=!0}clearTemporaryItem(){this.finishedEditing=null,this.temporaryCollectionItemNodeId=void 0}};ve=oe(null),Nn=new WeakMap,An=new WeakMap,Bn=new WeakMap,Dn=new WeakMap,E(ve,4,"isHidden",Qc,rt,Nn),E(ve,4,"finishedEditing",Jc,rt,An),E(ve,4,"_screenWidth",Zc,rt,Bn),E(ve,4,"_temporaryCollectionItemNodeId",Xc,rt,Dn),re(ve,rt);function Sm(r,o){let e=r.getSlugVariable();if(e?.associatedStringVariable){let t=o.getControlProp(e.associatedStringVariable);if(t&&t.type==="string"&&se(t.value)&&t.value.trim())return t.value.trim()}return"a new page"}var Cr=class{updateComponentLoader(o,e){ne.setModuleRevision(e,0);for(let t of o)ne.updateEntity(t.identifier,t)}};var Em=0,ef,Fr,Rn,Jt;ef=[R()];var Zt=class{constructor(o){this.scheduler=o;D(this,Rn,C(Fr,8,this)),C(Fr,11,this);D(this,Jt);window.addEventListener("resize",()=>{this._editableNodesHighlight&&(this._editableNodesHighlight=void 0)})}get editableNodesHighlight(){return this._editableNodesHighlight}onChangeRoute(){this._editableNodesHighlight&&(this._editableNodesHighlight=void 0)}cleanupAnimationOnFinish(o){At(this,Jt)&&clearTimeout(At(this,Jt)),ho(this,Jt,window.setTimeout(()=>{this._editableNodesHighlight=void 0},o+100))}highlight(o,{type:e}){let t=me({screenWidth:o.stores.canvasStore.screenWidth,tree:o.stores.treeStore.tree,webPageNodeId:o.stores.routeStore.webPageNodeId});if(!t)return;let n=[],i={x:0,y:window.scrollY,width:window.innerWidth,height:window.innerHeight},a=1/0,l=-1/0,s=!1;for(let f of t.walk())for(let[m]of f.cache.iterateRenderInstances()){if(!Re.isHighlightableNode(o,f,m))continue;s=!0;let c=o.tree.convertFrameToCanvas(f,void 0,m);if(!Tm(i,c))continue;a=Math.min(a,c.y),l=Math.max(l,c.y+c.height);let u=o.tree.getRect(f,void 0,void 0,void 0,m),d=o.tree.transformMatrixToNode(f,void 0,void 0,m);n.push({renderId:m,width:u.width,height:u.height,transform:d.toString(),centerX:c.x+c.width/2,centerY:c.y+c.height/2})}if(n.length===0)dt({key:"editable-nodes-highlight-empty",type:"add",text:s?"Editable content is out of view, scroll to reveal it":"Content is not editable on this page",variant:"info"}),this._editableNodesHighlight=void 0;else{let f=e==="clickOnVoid",m=f?o.stores.mouseStore.windowMousePosition.x:i.width,c=f?o.stores.mouseStore.windowMousePosition.y:i.height/2,u=f?o.stores.mouseStore.canvasMousePosition.y:o.stores.mouseStore.scrollPosition.y,d=400,w=Math.max(m,window.innerWidth-m),I=Math.max(c,window.innerHeight-c),U=Math.sqrt(w**2+I**2)+d,T=Math.max(500,e==="clickOnVoid"?U:U*2),S=5,P=Math.max(0,Math.floor(a-S)),F=Math.ceil(l+S),b=Nm(n,U,m,u);this._editableNodesHighlight={animationId:`editable-nodes-highlight-${Em++}`,minY:P,maxY:F,originX:m,originY:c-P+i.y,highlights:n,minRadius:b,maxRadius:U,gradientSize:d,animationDuration:T},this.cleanupAnimationOnFinish(T)}}};Fr=oe(null),Rn=new WeakMap,Jt=new WeakMap,E(Fr,4,"_editableNodesHighlight",ef,Zt,Rn),re(Fr,Zt);function Tm(r,o){return!(o.x>=Te.maxX(r)||Te.maxX(o)<=r.x||o.y>=Te.maxY(r)||Te.maxY(o)<=r.y)}function Nm(r,o,e,t){let n=1/0;for(let i of r){let a=Math.sqrt(i.width**2+i.height**2),l=Math.abs(i.centerX-e),s=Math.abs(i.centerY-t),f=Math.sqrt(l**2+s**2),m=Math.max(0,f-a/2);n=Math.min(n,m)}return Number.isFinite(n)&&n<o?n:0}var xr=class extends as{constructor(){super(...arguments);y(this,"hostnames");y(this,"testing",{setHostnames:e=>{this.hostnames=e}})}get customHostnameString(){return this.hostnames?.find(e=>e.type==="custom")?.hostname}get defaultHostnameString(){return this.hostnames?.find(e=>e.type==="default")?.hostname}async loadHostnames(e){let{hostnames:t}=await is(e);this.hostnames=t}};var Pr=class extends Ne{constructor(e){super();this.sandboxStore=e}async ensureModuleEvaluatedInSandbox(e){return(await this.sandboxStore.getModulesRuntime()).loadModule(e.value)}hasModuleForIdentifier(e){return!!ne.componentForIdentifier(e.value)}};var br=class extends Ne{constructor(e){super();this.accessStore=e;y(this,"isLoginInProgress",!1)}login(){let e=window.open(`${Uo().login}?closeAfterSuccess=true`,"_blank");return e?this.startLoginWindowClosedPolling(e):Promise.resolve()}startLoginWindowClosedPolling(e){return this.isLoginInProgress=!0,new Promise(n=>{let i=setInterval(async()=>{e.closed&&(clearInterval(i),await this.accessStore.refresh(),this.isLoginInProgress=!1,n())},500)})}};var tf,of,rf,nf,af,sf,lf,df,cf,W,kn,Mn,On,Vn,Ln,_n,Wn,Hn;cf=[R()],df=[R(ie.isEqual)],lf=[R(ie.isEqual)],sf=[R()],af=[Ut(ie.isEqual)],nf=[R()],rf=[R()],of=[R()],tf=[R()];var Ce=class{constructor(o){this.scheduler=o;C(W,5,this);D(this,kn,C(W,8,this)),C(W,11,this);D(this,Mn,C(W,12,this,ie(0,0))),C(W,15,this);D(this,On,C(W,16,this,ie(0,0))),C(W,19,this);D(this,Vn,C(W,20,this,!1)),C(W,23,this);D(this,Ln,C(W,24,this,!1)),C(W,27,this);D(this,_n,C(W,28,this,!1)),C(W,31,this);D(this,Wn,C(W,32,this,{canvasMousePosition:ie(0,0),windowMousePosition:ie(0,0)})),C(W,35,this);D(this,Hn,C(W,36,this,{canvasMousePosition:ie(0,0),windowMousePosition:ie(0,0)})),C(W,39,this);let e=this.onMouseMove.bind(this);document.addEventListener("mousemove",e);let t=this.onScroll.bind(this);document.addEventListener("scroll",t);let n=this.onMouseDown.bind(this);document.addEventListener("mousedown",n);let i=this.onMouseUp.bind(this);document.addEventListener("mouseup",i)}get lastUpdateType(){return this._lastUpdateType}get scrollPosition(){return this._scrollPosition}get windowMousePosition(){return this._windowMousePosition}get isMouseDown(){return this._isMouseDown}get canvasMousePosition(){return ie.add(this.windowMousePosition,this.scrollPosition)}get isHoveringChrome(){return this._isHoveringChrome}get isHoveringFloatingCanvasChrome(){return this._isHoveringFloatingCanvasChrome}get latest(){return this._latest}get previous(){return this._previous}updateInputState(){this._previous={canvasMousePosition:this._latest.canvasMousePosition,windowMousePosition:this._latest.windowMousePosition},this._latest={canvasMousePosition:this.canvasMousePosition,windowMousePosition:this.windowMousePosition}}onScroll(){this._scrollPosition=ie(window.scrollX,window.scrollY),this._lastUpdateType="scroll",this.updateInputState()}onMouseMove(o){this._isHoveringChrome=El(o.target),this._isHoveringFloatingCanvasChrome=Tl(o.target),this._windowMousePosition=ie(o.clientX,o.clientY),this._lastUpdateType="mouseMove",this.updateInputState()}onMouseDown(o){this._isMouseDown=!0,this._lastUpdateType="mouseDown",this.updateInputState()}onMouseUp(){this._isMouseDown=!1,this._lastUpdateType="mouseUp",this.updateInputState()}};W=oe(null),kn=new WeakMap,Mn=new WeakMap,On=new WeakMap,Vn=new WeakMap,Ln=new WeakMap,_n=new WeakMap,Wn=new WeakMap,Hn=new WeakMap,E(W,4,"_lastUpdateType",cf,Ce,kn),E(W,4,"_scrollPosition",df,Ce,Mn),E(W,4,"_windowMousePosition",lf,Ce,On),E(W,4,"_isMouseDown",sf,Ce,Vn),E(W,2,"canvasMousePosition",af,Ce),E(W,4,"_isHoveringChrome",nf,Ce,Ln),E(W,4,"_isHoveringFloatingCanvasChrome",rf,Ce,_n),E(W,4,"_latest",of,Ce,Wn),E(W,4,"_previous",tf,Ce,Hn),re(W,Ce);var vr=class extends Ne{constructor(){super(...arguments);y(this,"colorModel","HEX")}};var ff=g(te());var Sr=class extends Ne{constructor(e,t){super();this.assetStore=e;this.treeStore=t;y(this,"_hasPermanentlyFailed",!1);y(this,"project");y(this,"projectPromise",new Bt);y(this,"filePickerRef",(0,ff.createRef)())}get hasPermanentlyFailed(){return this._hasPermanentlyFailed}getProject(){return this.projectPromise}get resourceLimits(){}get featureFlags(){}get projectLicenseType(){return"freeSite"}loadProject(e,t){Ht(),!this.project&&(this.project=new bl(this.treeStore.timeline,e,t),this.project.connect(),this.project.on("disconnect",this.onDisconnect,this),this.project.connection.on("disconnect",this.onDisconnect,this),this.project.on("update",n=>{this.treeStore.newTreeAfterRemoteUpdate(n)}),this.assetStore.setAssetService(this.project.assetService),this.projectPromise.resolve(this.project))}onDisconnect(e){cs(e)||(this._hasPermanentlyFailed=!0,e==="ClientNeedsUpdate"?dt({type:"add",variant:"warning",text:"A new version of Framer is available. Please reload the page to continue working.",key:"client-outdated",duration:1/0,icon:"warning",showCloseButton:"never"}):e==="Maintenance"?dt({type:"add",variant:"warning",text:"Framer is undergoing maintenance. Please reload to continue once we\u2019re back.",key:"maintenance-mode",duration:1/0,icon:"warning",showCloseButton:"never",action:{title:"Reload",onClick:()=>window.location.reload()}}):dt({type:"add",variant:"error",text:"Connection error: "+e,key:"connection-error",duration:1/0,icon:"error",showCloseButton:"never"}))}commitTreeAndSend(e=!0){p(this.project,"Project must be initialized"),p(!this.hasPermanentlyFailed,"Project is permanently failed");let t=this.treeStore.timeline.commitLocalTree();this.treeStore.newTreeAfterLocalUpdate(t,e),this.project.maybeSend()}};function mf(r){return window.editorBarFeatures[r]===!0}var pf,uf,gf,Ye,zn,jn,qn;gf=[R()],uf=[R()],pf=[R()];var pt=class{constructor(o,e){this.scheduler=o;this.onChangeRoute=e;D(this,zn,C(Ye,8,this)),C(Ye,11,this);D(this,jn,C(Ye,12,this)),C(Ye,15,this);D(this,qn,C(Ye,16,this,_r)),C(Ye,19,this);let t=({data:n})=>{if(st(n)&&n.apiVersion===1){let{type:i,nodeIds:a}=n;if(i==="updateNodeIds"&&st(a)){let{webPageNodeId:l,collectionItemNodeId:s,activeLocaleId:f}=a;this._webPageNodeId=se(l)?l:void 0,this._collectionItemNodeId=se(s)?s:void 0,this.localeId=se(f)&&mf("onPageLocalizationSupport")?f:_r,this.onChangeRoute()}}};window.addEventListener("message",t),window.parent.postMessage({apiVersion:1,type:"initializeComponent",component:"OnPageActiveRouteStore"},"*")}get collectionItemNodeId(){return this._collectionItemNodeId}get webPageNodeId(){return this._webPageNodeId}get projectLinkNodeId(){return this._collectionItemNodeId??this._webPageNodeId}};Ye=oe(null),zn=new WeakMap,jn=new WeakMap,qn=new WeakMap,E(Ye,4,"_collectionItemNodeId",gf,pt,zn),E(Ye,4,"_webPageNodeId",uf,pt,jn),E(Ye,4,"localeId",pf,pt,qn),re(Ye,pt);var yf="iframe_icxp2h1";var Er=class extends Ne{constructor(e,t,n,i){super();this.componentsStore=e;this.treeStore=t;this.performanceTracker=n;this.updateGenerator=i;y(this,"config",Hs.onPageCanvas);y(this,"iframe");y(this,"remoteSandbox");y(this,"remoteControlsVisibility",new Bt);y(this,"remoteModulesRuntime",new Bt);y(this,"_canvasHeight");y(this,"webPageNodeIdToInitialLoadPromise",new Map);window.addEventListener("scroll",()=>{this.remoteSandbox?.scrollTo({behavior:"instant",top:window.scrollY})})}getControlsVisibility(){return this.remoteControlsVisibility}getModulesRuntime(){return this.remoteModulesRuntime}get canvasHeight(){return this._canvasHeight}loadSandbox(){Ht(),p(!this.iframe,"Sandbox already loaded");let e=document.createElement("iframe");e.src=this.config.url,e.allow=Ls,e.sandbox.add("allow-scripts","allow-same-origin"),e.tabIndex=-1,e.id="canvas_sandbox",e.className=yf;let t=this.initializeSandbox.bind(this,e);e.addEventListener("load",t),this.iframe=e,this.hide(),document.body.append(e)}getInitialLoadPromise(e){let t=this.webPageNodeIdToInitialLoadPromise.get(e)??new Bt;return this.webPageNodeIdToInitialLoadPromise.set(e,t),t}async waitForInitialLoad(e){this.performanceTracker.reportCanvasLoaderViewed(),await this.getInitialLoadPromise(e)}async initializeSandbox(e){let t=e.contentWindow;p(t,"Sandbox didn't load correctly");let n=new _s(tt);n.setLocal(tt.channels.componentsStore,this.componentsStore),n.setLocal(tt.channels.sandboxStore,this),n.setLocal(tt.channels.treeStore,this.treeStore);let i=n.getRemote(tt.channels.sandbox),a=n.getRemote(tt.channels.controlsVisibility),l=n.getRemote(tt.channels.modulesRuntime),s=n.getRemote(tt.channels.flags);await n.connect({target:t,url:this.config.origin}),this.remoteSandbox=i,this.remoteControlsVisibility.resolve(a),this.remoteModulesRuntime.resolve(l),new Ws(s)}onHeightChange(e){this._canvasHeight=e}onInitialLoadComplete(e){this.performanceTracker.reportCanvasReady(),this.getInitialLoadPromise(e).resolve()}update(){let e=this.remoteSandbox;if(!e)return;let t=this.updateGenerator.getUpdate();Io(t)||e.update(t)}hide(){p(this.iframe,"Sandbox not loaded"),this.iframe.setAttribute("aria-hidden","true")}show(){p(this.iframe,"Sandbox not loaded"),this.iframe.removeAttribute("aria-hidden")}};var hf,Kn;hf=[Ut()];var Qt=class{constructor(o,e,t){this.scheduler=o;this.routeStore=e;this.treeStore=t;C(Kn,5,this)}get active(){let o=ot({tree:this.treeStore.tree,webPageNodeId:this.routeStore.webPageNodeId});return k(o,"webPageNode must be defined"),o}};Kn=oe(null),E(Kn,2,"active",hf,Qt),re(Kn,Qt);function wf({editorNode:r,screenWidth:o,tree:e,webPageNodeId:t,windowMousePositionOnToolEntry:n}){let i=me({screenWidth:o,tree:e,webPageNodeId:t});if(!i)return;let a=e.convertFrameToCanvas(r),l=e.getNodesInRect(i,a,!0),s=[],f=i.cache.layoutTemplateRects;if(f)for(let[S,P]of f)!P.canvasRect||!Te.intersects(P.canvasRect,a)||s.push(new zi({zIndex:P.domRect.zIndex,id:S,parentid:i.id}));let m=l.concat(s),c=ko(m,e,{[i.id]:s}),u=c.findIndex(S=>S.id===r.id);if(u===-1)return;let d=c.slice(u+1);if(d.length===0)return;let I=e.transformMatrixToNode(r).inverse(),U=n?{x:n.x+window.scrollX,y:n.y+window.scrollY,width:1,height:1}:void 0,T=[];for(let S of d){let P=f?.get(S.id),F=e.convertFrameToCanvas(S);if(U&&Te.intersects(U,F))continue;let b;if(P?.canvasCorners?b=P.canvasCorners:b=e.convertCornerPointsToCanvas(S),b.length===0)continue;let N=[];for(let{x:Ee,y:$e}of b){let ze=new DOMPoint(Ee,$e).matrixTransform(I);N.push({x:ze.x,y:ze.y})}N.length!==0&&T.push(N)}if(T.length!==0)return{editorRect:a,polygons:T}}function If({editorRect:r,polygons:o}){let e=`M ${-ut},${-ut} L ${-ut},${r.height+ut} L ${r.width+ut},${r.height+ut} L ${r.width+ut},${-ut} Z`;for(let t of o){let n=t[0];if(!n)continue;let i=[...t,n];for(let a of i)e+=` L ${a.x},${a.y}`;e+=" Z"}return`path("${e}")`}function Uf(r){let o=[];for(let e of r){if(e.length===0)continue;let[t,...n]=e;if(!t)continue;let i=`M ${t.x},${t.y}`;for(let a of n)i+=` L ${a.x},${a.y}`;i+=" Z",o.push(i)}if(o.length!==0)return`path("${o.join(" ")}")`}var ut=100;var Cf,Ff,xf,Pf,bf,vf,Sf,Ef,Z,Gn,Yn,$n,Xn,Zn,eo,Jn;Ef=[R()],Sf=[R()],vf=[R()],bf=[R()],Pf=[R()],xf=[R()],Ff=[Ut()],Cf=[Ut()];var Se=class{constructor(o,e,t,n,i){this.scheduler=o;this.treeStore=e;this.routeStore=t;this.canvasStore=n;this.mouseStore=i;C(Z,5,this);D(this,Gn,C(Z,8,this)),C(Z,11,this);D(this,Yn,C(Z,12,this,Mr)),C(Z,15,this);D(this,$n,C(Z,16,this)),C(Z,19,this);D(this,Xn,C(Z,20,this,null)),C(Z,23,this);D(this,Zn,C(Z,24,this)),C(Z,27,this);D(this,eo);D(this,Jn,C(Z,28,this)),C(Z,31,this)}get tool(){return this._tool}set tool(o){ho(this,eo,this.mouseStore.windowMousePosition),this._tool!==o&&(this._tool?.stop?.(),this._tool=o)}get windowMousePositionOnToolEntry(){return At(this,eo)}get editorClipGeometryEntry(){let o=this.nodeInTextEditorId;if(!o||o===Mr)return null;let e=ht(o),t=this.treeStore.tree.get(e);if(!t)return null;let n=wf({domLayoutUpdate:this.treeStore.domLayoutUpdate,editorNode:t,screenWidth:this.canvasStore.screenWidth,tree:this.treeStore.tree,webPageNodeId:this.routeStore.webPageNodeId,windowMousePositionOnToolEntry:At(this,eo)});return n?{nodeId:e,geometry:n}:null}get editorOverlayClipPath(){let o=this.editorClipGeometryEntry;if(o)return If(o.geometry)}get sandboxNodeInTextEditorClipPath(){let o=this.editorClipGeometryEntry;if(o)return Uf(o.geometry.polygons)}validateCollectionControl(o){let e="required";if(!o)return;let{collectionItemNode:t,variableDefinition:n,collectionNode:i,controlDescription:a,controlProp:l}=o,s;(bo(n)||ao(n))&&(s=qo(n,i.variables,t));let f=jo(i,t),m=n.type,c=Ko(m,a,l,s,void 0,vo(n),f.get(n.id));this.validationWarning=c?.type===e?void 0:c}};Z=oe(null),Gn=new WeakMap,Yn=new WeakMap,$n=new WeakMap,Xn=new WeakMap,Zn=new WeakMap,eo=new WeakMap,Jn=new WeakMap,E(Z,4,"highlightedRenderId",Ef,Se,Gn),E(Z,4,"nodeInTextEditorId",Sf,Se,Yn),E(Z,4,"proseMirror",vf,Se,$n),E(Z,4,"proseMirrorView",bf,Se,Xn),E(Z,4,"_tool",Pf,Se,Zn),E(Z,4,"validationWarning",xf,Se,Jn),E(Z,2,"editorClipGeometryEntry",Ff,Se),E(Z,2,"editorOverlayClipPath",Cf,Se),re(Z,Se);var Tf,Nf,St,Qn,ei;Nf=[R()],Tf=[R()];var Et=class{constructor(o,e,t){this.scheduler=o;this.routeStore=e;this.undoRedoManager=t;y(this,"layoutCache",new Za);y(this,"sandboxCollectionData",new Ja("editor"));y(this,"sandboxVisibility",new Qa("editor"));D(this,Qn,C(St,8,this,ta.createWithRouteSegmentRoot())),C(St,11,this);D(this,ei,C(St,12,this,0)),C(St,15,this);y(this,"timeline",new ts(this.tree));y(this,"treeIndexes",new ti(this))}get tree(){return this._tree}get domLayoutUpdate(){return this._domLayoutUpdate}get remoteTreeVersion(){return this.timeline.remoteTreeVersion}getChangesForUndo(){let o=this.timeline.getLatestChangesForUndo();return o?o.filter(e=>!e.ignoreInUndo):[]}hasChanged(){return this.undoRedoManager.getUndoBufferSize()>0}getPartialIndexes(){return this.treeIndexes}getLoadedIndexes(){let o=this.tree.getService("loader");if(o){let e=o.numberOfScopesToLoad();throw new Error(`Some scopes are still loading: ${e} scopes left to load`)}return this.treeIndexes}onLayoutMeasure(o){let e=this.layoutCache.processLayoutMeasurements(o);e.size===0||Da(this.tree,this.layoutCache,e).size===0||this._domLayoutUpdate++}onSandboxRendered(o){let e=new Set;if(o.collectionUpdates){let t=this.sandboxCollectionData.import(o.collectionUpdates);for(let n of t){let i=ht(n);e.add(i)}}if(o.visibilityUpdates){let t=this.sandboxVisibility.import(o.visibilityUpdates);for(let n of t){let i=ht(n);e.add(i)}}if(e.size>0){let t=os(this.tree,e);Vo(this.tree,this.layoutCache,this.sandboxCollectionData,this.sandboxVisibility,ne.activeBundleHash,this.routeStore.localeId,void 0,t)}o.layoutMeasurements&&this.onLayoutMeasure(o.layoutMeasurements)}newTreeAfterRemoteUpdate(o){o.inEditor=!0,this._tree!==o&&(this._tree=o)}newTreeAfterLocalUpdate(o,e){if(o.inEditor=!0,this._tree===o)return;this._tree=o;let t=this.getChangesForUndo();e&&t.length>0&&this.undoRedoManager.addUndoEntry({changes:t})}};St=oe(null),Qn=new WeakMap,ei=new WeakMap,E(St,4,"_tree",Nf,Et,Qn),E(St,4,"_domLayoutUpdate",Tf,Et,ei),re(St,Et);var ti=class{constructor(o){this.treeStore=o;y(this,"codeComponentNodeCache");y(this,"richTextNodeCache")}get codeComponents(){let o=this.treeStore.tree;if(this.codeComponentNodeCache?.tree===o)return this.codeComponentNodeCache.codeComponentNodes;let e=[];for(let t of o.root.walk())Oe(t)&&e.push(t);return this.codeComponentNodeCache={tree:o,codeComponentNodes:e},e}get richTextNodes(){let o=this.treeStore.tree;if(this.richTextNodeCache?.tree===o)return this.richTextNodeCache.richTextNodes;let e=[];for(let t of o.root.walk())A(t)&&e.push(t);return this.richTextNodeCache={tree:o,richTextNodes:e},e}};var Tr=class extends ls{};var Nr=class{constructor(o,e,t){y(this,"accessStore");y(this,"assetStore");y(this,"canvasStore");y(this,"componentsStore");y(this,"contextMenuStore");y(this,"editableNodeHighlightStore");y(this,"hostnameStore");y(this,"loadedExternalModulesStore");y(this,"loginStore");y(this,"modalStore");y(this,"modulesStore");y(this,"mouseStore");y(this,"persistedUserDefaults");y(this,"projectStore");y(this,"routeStore");y(this,"sandboxStore");y(this,"scopeStore");y(this,"toolStore");y(this,"treeStore");y(this,"undoRedoManager",new Tr);y(this,"vectorsStore");this.assetStore=new vt(e),this.editableNodeHighlightStore=new Zt(e),this.routeStore=new pt(e,()=>o.onChangeRoute()),this.componentsStore=new Cr,this.contextMenuStore=ns.new(e),this.hostnameStore=xr.new(e),this.modalStore=oa.new(e),this.treeStore=new Et(e,this.routeStore,this.undoRedoManager),this.projectStore=Sr.new(e,this.assetStore,this.treeStore),this.accessStore=Ur.new(e,this.projectStore,this.hostnameStore,t),this.loginStore=br.new(e,this.accessStore),this.mouseStore=new Ce(e),this.canvasStore=new rt(e,this.accessStore,this.routeStore,this.treeStore,this.projectStore,this.modalStore,this.undoRedoManager,()=>o.exitTool(),()=>o.onChangeRoute()),this.toolStore=new Se(e,this.treeStore,this.routeStore,this.canvasStore,this.mouseStore),this.scopeStore=new Qt(e,this.routeStore,this.treeStore),this.sandboxStore=Er.new(e,this.componentsStore,this.treeStore,o.performanceTracker,o.sandboxUpdateGenerator),this.loadedExternalModulesStore=Pr.new(e,this.sandboxStore),this.modulesStore=Ya.new(e,this.treeStore,this.loadedExternalModulesStore,{codeEditorPreviewVisible:!1,mainView:0},this.projectStore.getProject().then(n=>n.modulesAPI),()=>{throw new Error("Can't make document readonly")},async n=>{await(await this.sandboxStore.getModulesRuntime()).insertTemporaryImportMap(n)},async()=>{throw new Error("Can't load all local modules")}),this.persistedUserDefaults=vr.new(e),this.vectorsStore=ds.new(e,this.modulesStore)}};var Ar=class{constructor(){y(this,"editorBarReadyAt");y(this,"canvasReadyAt");y(this,"canvasLoaderViewedAt")}get editorBarReadyMs(){let o=Bm();if(!(xe(o)||xe(this.editorBarReadyAt)))return this.editorBarReadyAt-o}get canvasReadyMs(){if(!(xe(this.canvasReadyAt)||xe(this.editorBarReadyAt)))return this.canvasReadyAt-this.editorBarReadyAt}get perceivedCanvasLoadMs(){if(!xe(this.canvasReadyAt))return xe(this.canvasLoaderViewedAt)?0:Math.min(this.canvasReadyAt-this.canvasLoaderViewedAt,0)}reportEditorBarReady(){this.editorBarReadyAt=Date.now()}reportCanvasLoaderViewed(){this.canvasLoaderViewedAt=Date.now()}reportCanvasReady(){this.canvasReadyAt=Date.now(),this.sendCanvasLoadedEvent()}sendCanvasLoadedEvent(){let{canvasReadyMs:o,editorBarReadyMs:e,perceivedCanvasLoadMs:t}=this;xe(o)||xe(e)||xe(t)||Ae("editor_bar_canvas_loaded",{editorBarReadyMs:e,canvasReadyMs:o,perceivedCanvasLoadMs:t})}};function Bm(){let r=new URLSearchParams(window.location.search).get("loadStart");if(!r)return;let o=Number(r);if(!Number.isNaN(o))return o}var Br=class{constructor(o){this.engine=o;y(this,"partialTreeSender");y(this,"previousWebPageNodeId");y(this,"previousCollectionItemNodeId");y(this,"previousBreakpointNodeId");y(this,"previousTemporaryCollectionItemNodeId");y(this,"previousStylePresetBreakpointClassNames");y(this,"previousLocalModules");y(this,"previousDependenciesModule");y(this,"previousAssets");y(this,"previousNodeInTextEditor");y(this,"previousNodeInTextEditorClipPath");y(this,"previousMoveToolState");y(this,"previousLocaleId")}getUpdate(){let{canvasStore:o,modulesStore:e,routeStore:t,assetStore:n,treeStore:i,toolStore:a}=this.engine.stores,l={},s=ot({tree:i.tree,webPageNodeId:t.webPageNodeId})?.id;s!==this.previousWebPageNodeId&&(this.previousWebPageNodeId=s,l.webPageNodeId=s);let f=Ke(t,i,o)?.id;f!==this.previousCollectionItemNodeId&&(this.previousCollectionItemNodeId=f,l.collectionItemNodeId=f);let m=me({screenWidth:o.screenWidth,tree:i.tree,webPageNodeId:t.webPageNodeId})?.id;m!==this.previousBreakpointNodeId&&(this.previousBreakpointNodeId=m,l.breakpointNodeId=m);let c=o.temporaryCollectionItemNodeId??null;c!==this.previousTemporaryCollectionItemNodeId&&(this.previousTemporaryCollectionItemNodeId=c,l.temporaryCollectionItemNodeId=c);let u=i.tree.getPresetsListNode(),d=Dm(u,o.screenWidth);d!==this.previousStylePresetBreakpointClassNames&&(this.previousStylePresetBreakpointClassNames=d,l.stylePresetBreakpointClassNames=d);let w=e.localModules;w!==this.previousLocalModules&&(this.previousLocalModules=w,l.localModules=new Map(w));let I=e.dependenciesModule;I!==this.previousDependenciesModule&&(this.previousDependenciesModule=I,l.dependenciesModule=I);let U=n.assets;U!==this.previousAssets&&(this.previousAssets=U,l.assets=U),this.partialTreeSender??=new zs(i.timeline,"canvas");let T=this.partialTreeSender.update(s);Io(T)||(l.partialTreeUpdate=T);let S=a.nodeInTextEditorId??null;S!==this.previousNodeInTextEditor&&(this.previousNodeInTextEditor=S,l.nodeInTextEditorId=S);let P=a.sandboxNodeInTextEditorClipPath??null;P!==this.previousNodeInTextEditorClipPath&&(this.previousNodeInTextEditorClipPath=P,l.nodeInTextEditorClipPath=P);let F=a.tool instanceof pe?a.tool.state:void 0;return fe(F,this.previousMoveToolState)||(this.previousMoveToolState=F,l.moveToolState=F??null),t.localeId!==this.previousLocaleId&&(this.previousLocaleId=t.localeId,l.activeLocaleId=t.localeId),l}},Dm=hi((r,o)=>{let e=js(r);return qs(e,o)});var Dr=class{constructor(o){this.siteId=o;y(this,"name","OnPageEngine");y(this,"sandboxUpdateGenerator",new Br(this));y(this,"performanceTracker",new Ar);y(this,"scheduler",new Ir(this));y(this,"stores");this.stores=new Nr(this,this.scheduler,o),this.stores.projectStore.getProject().then(e=>{p(this.stores.assetStore.assetService,"assetsService must be initialized"),$a(this,this.stores.assetStore.assetService,this.stores.projectStore.filePickerRef),Oa(e.api,this.stores.assetStore.assetService),this.stores.modulesStore.initialize().catch(ae),e.connection.on("connect",t=>{t&&this.stores.modulesStore.refresh().catch(ae)})})}get tree(){return this.stores.treeStore.tree}startHighlightTool(){this.stores.toolStore.tool=new Re(this)}startComponentInstanceEditTool(o,e){this.stores.toolStore.tool=new Le(this,o,e)}startDateVariableEditTool(o,e,t){this.stores.toolStore.tool=new _e(this,o,e,t)}startCollectionReferenceVariableEditTool(o,e,t){this.stores.toolStore.tool=new Ve(this,o,e,t)}startEnumVariableEditTool(o,e,t){this.stores.toolStore.tool=new We(this,o,e,t)}startImageEditTool(o,e){this.stores.toolStore.tool=new He(this,o,e)}startRichTextEditTool(o,e,t){this.stores.toolStore.tool=new ye(this,o,e,t)}startRichTextVariableEditTool(o,e,t){this.stores.toolStore.tool=new Be(this,o,e,t)}startStringVariableEditTool(o,e,t){this.stores.toolStore.tool=new De(this,o,e,t)}startMoveTool(o,e,t){this.stores.toolStore.tool=new pe(this,o,e,t)}exitTool(){this.startHighlightTool()}onChangeRoute(){this.stores.editableNodeHighlightStore.onChangeRoute(),this.exitTool()}getStateToken(){return this.stores.undoRedoManager.getUndoBufferSize()}undo(){let{undoRedoManager:o,toolStore:e,projectStore:t}=this.stores;e.tool?.undo?e.tool.undo():o.peekUndo()&&(o.undo(this.tree),t.commitTreeAndSend(!1))}redo(){let{undoRedoManager:o,toolStore:e,projectStore:t}=this.stores;e.tool?.redo?e.tool.redo():o.peekRedo()&&(o.redo(this.tree),t.commitTreeAndSend(!1))}beginUndoGroup(){this.stores.undoRedoManager.beginUndoGroup()}endUndoGroup(){this.stores.undoRedoManager.scheduleEndUndoGroup()}};var gt=g(h());gi({enableFontStore:!0,fetchGoogleFontsList:us,fetchFontshareFontsList:ps,fetchBuiltInFontsList:fs});async function av(r,o){let e=new Dr(o);await e.stores.accessStore.set(r),e.stores.sandboxStore.loadSandbox(),rs(e.stores.assetStore.assetMap),at.importFramerFonts(Ti),Ga(),Object.assign(window,{engine:e,componentLoader:ne}),ms((0,gt.jsx)(Ri.Provider,{value:e,children:(0,gt.jsx)(Ns,{forceDarkMode:!0,children:(0,gt.jsx)(wa,{mode:"onPageEditing",children:(0,gt.jsxs)(vl,{children:[(0,gt.jsx)(Hc,{}),(0,gt.jsx)(jc,{})]})})})}),document.getElementById("root"))}export{av as renderEditorBar};
//# sourceMappingURL=https://app.framerstatic.com/render-Q3C4NJ6U.mjs.map
