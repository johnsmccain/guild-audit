import{c as A,d as V}from"https://app.framerstatic.com/chunk-Q5MITPIS.mjs";import{a as L,b as P}from"https://app.framerstatic.com/chunk-NIDOI5EE.mjs";import{c as x,e as v,h as T,k as I}from"https://app.framerstatic.com/chunk-WWFRYK5U.mjs";import{e as b,l as y,m as _,v as F}from"https://app.framerstatic.com/chunk-35MJ64JF.mjs";import{e as M}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var{onewayMethodTemplate:ne,voidMethodTemplate:oe,valueMethodTemplate:ae,streamMethodTemplate:R}=I,C;(p=>p.service={id:"__Flags__",fingerprint:"2dc758b5859fc43cd99a9ea5569fd9d8",methods:{experimentsUpdatesStream:{},employeesOnlySettingsUpdatesStream:{},projectFeaturesUpdatesStream:{}},newOutgoingWrapper:a=>({experimentsUpdatesStream:R.bind(-1,"experimentsUpdatesStream",a),employeesOnlySettingsUpdatesStream:R.bind(-1,"employeesOnlySettingsUpdatesStream",a),projectFeaturesUpdatesStream:R.bind(-1,"projectFeaturesUpdatesStream",a)})})(C||={});var W;(n=>{n.service=C.service;function p(t){let o=v.shared();return{expect:()=>o.expectWithoutDiscovery(n.service,t),discover:i=>o.discover(n.service,t,i),register:i=>o.register({channel:t,service:n.service,implementation:i})}}n.on=p;async function a(t){v.shared().unregister(t)}n.unregister=a})(W||={});var{onewayMethodTemplate:xe,voidMethodTemplate:Ie,valueMethodTemplate:Re,streamMethodTemplate:j}=I,U;(p=>p.service={id:"__ModulesUpdates__",fingerprint:"94442ac22b31297c9938132d5ea74437",methods:{moduleUpdatesStream:{}},newOutgoingWrapper:a=>({moduleUpdatesStream:j.bind(-1,"moduleUpdatesStream",a)})})(U||={});var J;(n=>{n.service=U.service;function p(t){let o=v.shared();return{expect:()=>o.expectWithoutDiscovery(n.service,t),discover:i=>o.discover(n.service,t,i),register:i=>o.register({channel:t,service:n.service,implementation:i})}}n.on=p;async function a(t){v.shared().unregister(t)}n.unregister=a})(J||={});var h=M(L());function Fe(r,p){let a={service:r.service.service,onDiscover:r.onDiscover},n=(0,h.useRef)(a);if(n.current.service!==a.service)throw new Error("useServiceStream: service must be identical between re-renders");let t={onStreamValue:p,onError:r.onError},o=(0,h.useRef)(t);o.current=t;let i=(0,h.useRef)(),g=()=>{let d=i.current;i.current=void 0,d?.cancel().catch(()=>{})},{channel:S}=r;(0,h.useEffect)(()=>S?((async()=>{let c=!1,E=0;for(;!c;){c=!0;try{let e=n.current,s=await v.shared().discover(e.service,S),f=e.onDiscover(s);i.current=f,E=0,await f.read(m=>o.current.onStreamValue(m))}catch(e){let s=o.current.onError(_(e));if(E++,E>1)continue;s?.retry===!0&&(await b(0),c=!1)}}})().catch(y),g):void 0,[S])}function Te(r){if(r instanceof x.ServiceGone)return{retry:!0};y(r)}var l=M(L());var H="autoplay; ambient-light-sensor; accelerometer; camera; display-capture; encrypted-media; fullscreen; geolocation; gyroscope; magnetometer; microphone; midi; picture-in-picture; usb; xr-spatial-tracking",Pe="autoplay",k="autoplay; ambient-light-sensor; accelerometer; camera; display-capture; encrypted-media; fullscreen; geolocation; gyroscope; magnetometer; microphone; midi; picture-in-picture; usb; xr-spatial-tracking; clipboard-read; clipboard-write";var D=M(P()),G=F("services:hooks:useiframewithchannel"),w=class extends Error{constructor(a,n={}){super(a);this.extras=n}};function Ne(r){let{onSetup:p=()=>{},targetOrigin:a,type:n,src:t}=r,o=t;if(t){let{pathname:e,search:s,hash:f}=new URL(t),m=`${e}${s}${f}`;V(m),o=A(m).url}let[i,g]=(0,l.useReducer)((e,s)=>(e&&v.shared().unregister(e).catch(f=>{f instanceof x.ServiceGone||y(f)}),s),null),S=(0,l.useRef)(null),d=(0,l.useRef)(null),c=(0,l.useRef)({onError:null,onLoad:null});return(0,l.useEffect)(()=>{if(!o||!S.current){d.current=null,i&&g(null);return}if(d.current)return;let e=document.createElement("iframe");e.src=o,e.style.border="none",e.style.display="block",e.style.height="100%",e.style.width="100%",e.dataset.testid=`${n}-iframe`,e.allowFullscreen=!0;let s=u=>{g(null),G.reportError(new w("iframe load error",{message:u.message,filename:u.filename,lineno:u.lineno,colno:u.colno,error:u.error}))};e.addEventListener("error",s),c.current.onError=s;let f=new URL(o,document.baseURI).origin,m=e.sandbox;m?.add("allow-downloads"),m?.add("allow-popups"),m?.add("allow-popups-to-escape-sandbox"),m?.add("allow-same-origin"),m?.add("allow-scripts"),m?.add("allow-forms"),e.allow=n==="canvas"?H:k,S.current.appendChild(e),d.current=e;let N=()=>{let{contentWindow:u}=e;return u?new T(u,a??f):(S.current?.removeChild(e),null)},O=()=>{let u=N();g(u)};return e.addEventListener("load",O),c.current.onLoad=O,p(e)},[i,g,p,o,a,n]),(0,l.useEffect)(()=>()=>{c.current.onError&&d.current?.removeEventListener("error",c.current.onError),c.current.onLoad&&d.current?.removeEventListener("load",c.current.onLoad),c.current.onError=null,c.current.onLoad=null,d.current=null,g(null)},[]),[(0,l.useCallback)(function(s){return(0,l.useEffect)(()=>{if(S.current?.children.length===0&&d.current)throw new Error("IFrameWithChannel was re-rendered. The Service connection will be broken.")}),(0,D.jsx)("div",{...s,ref:S})},[]),i,d.current]}export{W as a,J as b,H as c,Pe as d,Ne as e,Fe as f,Te as g};
//# sourceMappingURL=https://app.framerstatic.com/chunk-6DVKAROJ.mjs.map
